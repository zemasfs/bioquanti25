<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Biothermodynamics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../avatar.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-70b236579891797f3b1e3a78f64d17d9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-S1L73VGCG5"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-S1L73VGCG5', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../logo-bioquanti.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../erre_en.html"> 
<span class="menu-text">Reproducible Teaching</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cheatsheets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Cheatsheets</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cheatsheets">    
        <li>
    <a class="dropdown-item" href="../../../cheatsheet/plotly.pdf">
 <span class="dropdown-text">Plotly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../cheatsheet/jmol_cheat.pt.pdf">
 <span class="dropdown-text">Jmol</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../cheatsheet/r_cheat.pt.pdf">
 <span class="dropdown-text">R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../producao_en.html"> 
<span class="menu-text">Works</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../contato_en.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../pt/index.html"> 
<span class="menu-text">PT</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-true"></i></a>
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-true"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Biothermodynamics</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">JSPlotly &amp; GSPlotly - Interactive Graphics &amp; AI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/jsplotly/jsplotly_geral_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JSPlotly - Graphical simulation with JavaScript</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/jsplotly/gsplotly_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GSPlotly - AI code generator for JSPlotly</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/jsplotly/jsptl_bioq_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulations in Biophysical Chemistry</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/jsplotly/jsplotly_bas_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulations at School</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Jmol - 3D molecules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/jmol/index_jmol_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Atomic models in Biochemistry</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/Curso/index_jmol_bas_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3D molecules at School</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/Jardim/index_Jardim_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Molecule Garden</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">R - Maths and visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/r/index_r_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R in Biophysical Chemistry</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/ScriptRplot/scriptrplot_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">scriptRplot: elegant graphics with ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/Curso/index_r_bas_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R &amp; RStudio at School</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/R/index_OIER_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactive charts and maps at School</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Sisma - dynamic diagrams</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/sisma/index_sisma_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamic flows in Biochemistry</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/sisma/index_sisma_bas_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactive diagrams at School</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Biothermodynamics</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-Bioenerg" class="level2">
<h2 class="anchored" data-anchor-id="sec-Bioenerg">Bioenergetics</h2>
<!-- Beer's Law ? -->
<div class="line-block">While <em>Kinetics</em> deals with the <em>flow</em> of information involving a phenomenon, <em>Thermodynamics</em> works with the <em>forces</em> involved in it. These forces, called <em>thermodynamic quantities</em>, help to understand various biological phenomena, such as the equilibria listed below.</div>
<ol type="1">
<li>Stability of biopolymers;</li>
<li>Ligand-receptor interaction;</li>
<li>Transport of biomolecules and ions;</li>
<li>Conformational changes in biomacromolecules;</li>
<li>Association of biopolymers;</li>
<li>Electron transfer in proteins;</li>
<li>Combustion and synthesis of biomolecules;</li>
<li>Generation of metabolic energy.</li>
</ol>
<div class="line-block">Although <em>Thermodynamics</em> is not responsible for explaining atomic theory, molecular mechanisms or reaction rates, its theoretical formalism allows us to evaluate the energy changes (<em>enthalpy, entropy, and Gibbs energy</em>) that occur between the initial and final states of a transformation. From these quantities, it is possible to sketch mechanistic models of the transformations involved, based on the empirical set of similar observations reported.</div>
<div class="line-block">The <em>Gibbs equation</em> for the equilibrium that describes these quantities is:</div>
<p><span id="eq-eqGibbs"><span class="math display">\[
\Delta G = \Delta H - T * \Delta S
\tag{1}\]</span></span></p>
<div class="line-block">Examples of this are the transformations in the values ​​of <span class="math inline">\(\Delta\)</span>H and <span class="math inline">\(\Delta\)</span>S that can be extracted from a conformational transition that accompanies the thermal denaturation of a protein <span class="citation" data-cites="cooper2004thermodynamics">(<a href="#ref-cooper2004thermodynamics" role="doc-biblioref">Cooper 2004</a>)</span>.</div>
<div class="line-block">To do this, it is necessary to determine the value of <span class="math inline">\(\Delta\)</span>G of the <em>phase transition</em>, which can be done in several ways, and using equally diverse methodology. Thus, through spectroscopic measurements (<em>molecular absorption, fluorescence, luminescence</em>), hydrodynamic measurements (<em>viscosity</em>, <em>sedimentation coefficient</em>, <em>osmotic pressure</em>), electrochemical measurements (<em>potentiometry, voltammetry</em>), or biological activity measurements, among many others, it is possible to quantify the thermodynamic parameter <span class="math inline">\(\Delta\)</span>G. This, in turn, can be extracted from the following relations, considering a <em>two-state transition</em>:</div>
<p><span id="eq-eqND"><span class="math display">\[
N \rightleftarrows D
\tag{2}\]</span></span></p>
<p><span id="eq-eqKeq"><span class="math display">\[
K_{eq} = \frac{[D]}{[N]}
\tag{3}\]</span></span></p>
<p><span id="eq-eqKeqDG"><span class="math display">\[
\Delta G = - R*T*ln(K_{eq})
\tag{4}\]</span></span></p>
<p>Where <em><span class="math inline">\(K_{eq}\)</span></em>, <em>[D]</em>, and <em>[N]</em> represent, respectively, the equilibrium constant for protein denaturation, as well as its concentrations in the denatured and native forms.</p>
<div class="line-block">A quick look at <a href="#eq-eqGibbs" class="quarto-xref">Equation&nbsp;22</a> makes it clear that this is a linear function with temperature. Thus, it is plausible to imagine a system in which the thermodynamic quantities above (<em><span class="math inline">\(K_{eq}\)</span></em> and, consequently, <em><span class="math inline">\(\Delta\)</span>G</em>) can be determined with temperature variation. Putting it into numbers:</div>
<p>At <span class="math inline">\(35^{o}\)</span>C: <span class="math inline">\(\Delta\)</span>G<span class="math inline">\(_{desn}\)</span> = <span class="math inline">\(\Delta\)</span>H<span class="math inline">\(_{desn}\)</span> - 308 * <span class="math inline">\(\Delta\)</span>S<span class="math inline">\(_{desn}\)</span> = +4.4 kJ <span class="math inline">\(mol^{-1}\)</span></p>
<p>At <span class="math inline">\(45^{o}\)</span>C: <span class="math inline">\(\Delta\)</span>G<span class="math inline">\(_{desn}\)</span> = <span class="math inline">\(\Delta\)</span>H<span class="math inline">\(_{desn}\)</span> - 318 * <span class="math inline">\(\Delta\)</span>S<span class="math inline">\(_{desn}\)</span> = -5.2 kJ <span class="math inline">\(mol^{-1}\)</span></p>
<div class="line-block">Understand that a solution to the problem involves solving the equations sequentially, subtracting one from the other to standardize an unknown (say, <span class="math inline">\(\Delta\)</span>S) that applied to the other equation will result in the second unknown (in this case, <span class="math inline">\(\Delta\)</span>H). Although plausible, this procedure is manual and loses value if we imagine a 3rd temperature tested for the protein denaturation in question.<br>
Another solution, more practical and computational, involves solving the <em>system of linear equations</em>, as follows:</div>
<p><span id="eq-eqSistLin"><span class="math display">\[
a_{11}*x_1 + a_{12} * x_2 = b_1
\\
a_{21}*x_1 + a_{22} * x_2 = b_2
\tag{5}\]</span></span></p>
<p>Where <em><span class="math inline">\(x_1\)</span></em> and <em><span class="math inline">\(x_2\)</span></em> represent, respectively, <span class="math inline">\(\Delta\)</span>H<span class="math inline">\(_{desn}\)</span> and <span class="math inline">\(\Delta\)</span>S<span class="math inline">\(_{desn}\)</span>.</p>
<div class="line-block">In this case, we can set up a <em>matrix system</em> such that:</div>
<p><span id="eq-eqMatrix"><span class="math display">\[
a_{11}*x_1 + a_{12} * x_2 = b_1
\\
a_{21}*x_1 + a_{22} * x_2 = b_2
\tag{6}\]</span></span></p>
<div class="line-block">That is,</div>
<p><span class="math display">\[
A = \begin{bmatrix}
a_{11} &amp; a_{12}\\
a_{21} &amp; a_{22}
\end{bmatrix} ,
\]</span></p>
<p><span class="math display">\[
x = \begin{bmatrix}
b_1\\
b_2
\end{bmatrix} ,
\]</span></p>
<p><span class="math display">\[
b = \begin{bmatrix}
x_1\\
x_2
\end{bmatrix}
\]</span></p>
<div class="line-block">Now solve the values ​​of <em>x</em> (or <span class="math inline">\(\Delta\)</span>’s) linearly:</div>
<p><span id="eq-eqAxb"><span class="math display">\[
A * x = b
\tag{7}\]</span></span></p>
<div class="line-block">Using <em>matrix algebra</em>, solve <a href="#eq-eqAxb" class="quarto-xref">Equation&nbsp;7</a> for the values ​​of <em>x</em>:</div>
<p><span id="eq-eqAm1xb"><span class="math display">\[
x = A^{-1} * b
\tag{8}\]</span></span></p>
<div class="line-block">Since this is a <em>system of linear equations</em>, this solution has in itself the premise that the values ​​of <span class="math inline">\(\Delta\)</span>H and <span class="math inline">\(\Delta\)</span>S do not vary in the temperature range studied.</div>
</section>
<section id="solution-of-a-system-of-linear-equations-in-r" class="level2">
<h2 class="anchored" data-anchor-id="solution-of-a-system-of-linear-equations-in-r">Solution of a system of linear equations in R</h2>
<div class="line-block">To solve the problem from the previous section using <code>R</code>, we first define the <em>matrix</em> for <em>A</em> and the matrix for <em>b</em> such that:</div>
<p><span class="math display">\[
A = \begin{bmatrix}
1 &amp; -308\\
1 &amp; -318
\end{bmatrix} ,
\]</span></p>
<p><span class="math display">\[
b = \begin{bmatrix}
+4.4\\
-5.2
\end{bmatrix}
\]</span></p>
<div class="line-block">Thus,</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definition of matrices</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">308</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">318</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="co"># matrix A;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the negative sign is due to the function having a negative slope</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">4.4</span>, <span class="sc">-</span><span class="fl">5.2</span>), <span class="at">ncol =</span> <span class="dv">1</span>) <span class="co"># matrix b</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">According to that presented in <a href="#eq-eqAm1xb" class="quarto-xref">Equation&nbsp;8</a>, the matrix solution can be obtained by the <code>solve</code> command:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix solution for linear system</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A) <span class="sc">%*%</span> b <span class="co"># # the %*% operation indicates the scalar product of two</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]
[1,] 300.08
[2,]   0.96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vectors ("dot product")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">In this case, the thermodynamic parameters found were <span class="math inline">\(\Delta\)</span>H<span class="math inline">\(_{desn}\)</span> = 300 kJ <span class="math inline">\(mol^{-1}\)</span> and <span class="math inline">\(\Delta\)</span>S<span class="math inline">\(_{desn}\)</span> = 960 J <span class="math inline">\(mol^{-1}\)</span>.</div>
<div class="line-block">Note the “%*%” notation for the multiplication of two matrices in the last line of the code. This is the <em>cross multiplication</em> or <em>dot product</em> of two matrices. Matrix multiplication is defined only for two dimensionally compatible matrices in a given order. This implies that the number of columns in the 1st matrix is ​​equal to the number of rows in the 2nd matrix. In this case, the resulting matrix will have the same number of rows as the 1st matrix and the same number of columns as the 2nd matrix. See the example:</div>
<p><span id="eq-matex"><span class="math display">\[
\begin{pmatrix}
1 \\
2 \\
3 \\
\end{pmatrix} *
\begin{pmatrix}
1 &amp; 2 &amp; 3 \\
\end{pmatrix}
= \begin{pmatrix}
1 &amp; 2 &amp; 3 \\
2 &amp; 4 &amp; 6 \\
3 &amp; 6 &amp; 9 \\
\end{pmatrix}
\tag{9}\]</span></span></p>
<div class="line-block">Another observation should also be made regarding the matrix solution of linear systems. A quick reflection on the linear nature of Gibbs’ <a href="#eq-eqGibbs" class="quarto-xref">Equation&nbsp;22</a> and its application to the solution of thermodynamic parameters for the system of linear equations above suggests that we could obtain other values ​​for <span class="math inline">\(\Delta\)</span>G from other tested temperatures. Assuming that there were, say, 5 or 6 values ​​of <em>T</em> with their respective values ​​of <span class="math inline">\(\Delta\)</span>G<span class="math inline">\(_{desn}\)</span>, and reinforcing the premise that the parameters <span class="math inline">\(\Delta\)</span>H<span class="math inline">\(_{desn}\)</span> and <span class="math inline">\(\Delta\)</span>S<span class="math inline">\(_{desn}\)</span> remained constant throughout the thermal range, we could easily conclude that it is a linear relationship of <span class="math inline">\(\Delta\)</span>G<span class="math inline">\(_{desn}\)</span> as a function of <span class="math inline">\(\Delta\)</span>H<span class="math inline">\(_{desn}\)</span> <em>T</em>.<br>
Thus, as seen in the <em>Enzymes</em> chapter, we could solve for the parameters <span class="math inline">\(\Delta\)</span>H<span class="math inline">\(_{desn}\)</span> and <span class="math inline">\(\Delta\)</span>SH<span class="math inline">\(_{desn}\)</span> by <em>linear fit</em>. In fact, one of the <em>Van’t Hoff</em> expressions that define this linear relationship is:</div>
<p><span id="eq-eqVHoff"><span class="math display">\[
ln \, K_{eq} = - \frac{\Delta H}{R} * \frac{1}{T} + \frac{\Delta S}{R}
\tag{10}\]</span></span></p>
<div class="line-block">Another direct consequence is that any set of data pairs of dependent (<em>y</em>) and independent (<em>x</em>) variables, and that exhibit homogeneity of variances and normal distribution, as explained in the <em>Enzymes</em> chapter, can also be solved for in its parameters (<em>intercept</em> and <em>slope</em>) with the help of matrix algebra.<br>
In fact, the linear adjustment matrix solution can be obtained from the relation below:</div>
<p><span id="eq-linMatr"><span class="math display">\[
\beta = (X^T \; X)^{-1} \; X^T*y
\tag{11}\]</span></span></p>
<div class="line-block">Therefore, the linear adjustment illustrated by the Lineweaver-Burk equation from the <em>Enzymes</em> chapter can also be performed with the help of matrices, although some statistical indicators presented in the table generated by the <code>lm</code> function are extracted by other functions of the matrix/statistical calculation algorithm. In <a href="#eq-linMatr" class="quarto-xref">Equation&nbsp;11</a> the term in parentheses involves the <em>inversion</em> operation of the matrix. In linear algebra there is no division operation for matrices, but only the multiplication of a matrix by a scalar or by the <em>inverse</em> of another. And even then, only if it is a <em>square matrix</em>. Thus, the term (X<span class="math inline">\(^{T}\)</span> X)<span class="math inline">\(^{-1}\)</span> can only be calculated with <em>matrix inversion</em>. In <code>R</code> this action is performed by the <code>solve</code> command.<br>
As before, it is also vitally important that the matrix <em>X</em> containing the independent variable is created with unit values ​​on the left, as follows:</div>
<p><span class="math display">\[
X = \begin{bmatrix}
1 &amp; x_{1}\\
1 &amp; x_{2}\\
1 &amp; x_{3}\\
... &amp; ...
\end{bmatrix}
\]</span></p>
<div class="line-block">Thus, the solution to the problem explained in the Lineweaver-Burk equation from the <em>Enzymes</em> chapter can be solved in a matrix as:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix solution for the Lineweaver-Burk kinetic parameters</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeating the data for the Lineweaver-Burk variables</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">20</span>) <span class="co"># generates a sequence with 20 points</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># between 0 and 1 for substrate values</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Vm <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Km <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># kinetic parameters</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1500</span>) <span class="co"># establishes the same random seed as the direct graph</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># of Michaelis-Menten, for reproducibility of the points</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># command for uniform error (no. of points, min, max)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> Vm <span class="sc">*</span> S <span class="sc">/</span> (Km <span class="sc">+</span> S) <span class="sc">+</span> error <span class="co"># Michaelis-Menten equation</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>inv.S <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> S <span class="co"># create variables for the double reciprocal</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>inv.v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> v</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Creation of matrices A and b</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>A2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">20</span>), inv.S), <span class="at">nrow =</span> <span class="dv">20</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>) <span class="co"># create matrix</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># with unit value required before the independent variable</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(inv.v, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>) <span class="co"># vector b</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix solution of the linear fit</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(A2) <span class="sc">%*%</span> A2) <span class="sc">%*%</span> <span class="fu">t</span>(A2) <span class="sc">%*%</span> b2</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>beta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] 0.11363419
[2,] 0.03277244</code></pre>
</div>
</div>
<div class="line-block">Note that the intercept (<span class="math inline">\(\beta\)</span> 1) and slope (<span class="math inline">\(\beta\)</span> 2) values ​​are close to those found with the help of the <code>lm</code> function of <code>R</code>.</div>
</section>
<section id="matrices-and-r" class="level2">
<h2 class="anchored" data-anchor-id="matrices-and-r">Matrices and <code>R</code></h2>
<div class="line-block">The use of matrices in solving linear problems and non-linear is quite vast. In fact, a linear fit is solved computationally by the use of matrices, rather than by summations. Likewise, some algorithms for non-linear fit also implement matrix algebra in problem solving (<em>Gauss-Newton</em>, <em>Levenberg-Marquadt</em>).<br>
Therefore, it is interesting to have a quick overview of the matrix potential that <code>R</code> has.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some manipulations with matrices</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Identifying rows and columns</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">308</span>, <span class="sc">-</span><span class="dv">318</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="co"># matrix definition</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Delta H"</span>, <span class="st">"Delta S"</span>), <span class="st">"kJ/mol"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        kJ/mol
Delta H   -308
Delta S   -318</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Arithmetic operations</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> T)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> T)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>m1 <span class="sc">+</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    6    7
[2,]    8    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="sc">-</span> <span class="dv">7</span> <span class="co"># addition or subtraction in scalar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   -3   -2
[2,]   -1    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>m1<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    4
[2,]    9   16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sin</span>(m2) <span class="co"># power or trigonometry</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]
[1,] -0.7568025 -0.9589243
[2,] -0.2794155  0.6569866</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="sc">+</span> m2 <span class="co"># addition of elements in matrices of equal dimension</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    5    7
[2,]    9   11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="sc">*</span> m2 <span class="co"># multiplication of elements in matrices of equal dimension</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    4   10
[2,]   18   28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="sc">%*%</span> m2 <span class="co"># dot product of vectors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   16   19
[2,]   36   43</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">det</span>(m1) <span class="co"># determinant of a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(m2) <span class="co"># transposition of a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    4    6
[2,]    5    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(m1) <span class="co"># diagonal matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(m2) <span class="co"># inverse of a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,] -3.5  2.5
[2,]  3.0 -2.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(m1) <span class="co"># eigenvalue and eigenvector of a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1]  5.3722813 -0.3722813

$vectors
           [,1]       [,2]
[1,] -0.4159736 -0.8245648
[2,] -0.9093767  0.5657675</code></pre>
</div>
</div>
<div class="line-block"><code>R</code> also supports several other operations used in numerical and symbolic calculations that use matrices, such as the functions <code>kronecker</code> (matrix multiplication), <code>svd</code> (<em>Single Value Decomposition</em>), <code>qr</code> (<em>QR Decomposition</em>), and <code>chol</code> (<em>Cholesky Decomposition</em>).</div>
</section>
<section id="solving-thermodynamic-parameters-of-enzyme-stability" class="level2">
<h2 class="anchored" data-anchor-id="solving-thermodynamic-parameters-of-enzyme-stability">Solving thermodynamic parameters of enzyme stability</h2>
<div class="line-block">Thermodynamic parameters, such as those contained in the <em>Van’t Hoff</em> expression, <a href="#eq-eqVHoff" class="quarto-xref">Equation&nbsp;10</a>, can also be obtained simultaneously by matrix algebra. For example, it is common in Biotechnology to evaluate thermostability parameters of enzymes subjected to thermal stress (as well as chemical stress, such as pH, urea or use of proteases). This is done in order to verify, for example, whether an enzyme can withstand high temperatures in industrial processes, to compare enzymes modified by site-directed mutation, or to evaluate the behavior of enzymes associated with various pathogenesis. The formalism of this analysis goes through the <em>Arrhenius Collision Theory</em>, as well as the <em>Eyring Transition State Theory</em>, resulting in the linear system of equations as follows:</div>
<p><span id="eq-termSist"><span class="math display">\[
\begin{cases}\Delta G^\ddagger = \Delta H^\ddagger-T* \Delta S^\ddagger
\\
ln(\frac{kcat*h}{K_B*T})=-\frac{1}{RT}*\Delta H^\ddagger + \frac{1}{R}*\Delta S^\ddagger
\end{cases}
\tag{12}\]</span></span></p>
<p>Where the terms with <span class="math inline">\(\ddagger\)</span> symbolize the variations of quantities related to the activation (or deactivation) of the enzyme (<em>transition state of the activated complex</em>), <em><span class="math inline">\(K_{B}\)</span></em> represents the Boltzmann constant (1.381x10<span class="math inline">\(^{-23}\)</span> JK<span class="math inline">\(^{-1}\)</span>), <em>h</em> the Planck constant (6.686x10<span class="math inline">\(^{-34}\)</span> J*s), and <em>R</em> the general gas constant (8.314 JK<span class="math inline">\(^{-1}\)</span> mol<span class="math inline">\(^{-1}\)</span>). It is not always possible to converge a matrix solution by simply using cross multiplication (<em>dot product</em>).</p>
<div class="line-block">The code snippet below exemplifies this attempt, based on the data published by Riaz et al <span class="citation" data-cites="bhatti2007effect">(<a href="#ref-bhatti2007effect" role="doc-biblioref">Bhatti et al. 2007</a>)</span> below, and previously considering the matrices <em>A</em> and <em>b</em> as a function of the parameters specified by the authors:</div>
<p><span id="eq-Bhatti"><span class="math display">\[
\Delta G^{\ddagger}=65920\, J\,mol^{-1} \\
T = 328 K \\
kcat = 217 s^{-1}
\tag{13}\]</span></span></p>
<p><span class="math display">\[
A = \begin{bmatrix}
1 &amp; -328\\
-3.67e-4 &amp; 0.120\\
\end{bmatrix} ,
\]</span></p>
<p><span class="math display">\[
b = \begin{bmatrix}
65920\\
-24.17\\
\end{bmatrix}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempt at a simple matrix solution in published data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Appl. Microbiol. Biotechnol, 73, 1290, 2007):</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">3.67e-4</span>, <span class="sc">-</span><span class="dv">328</span>, <span class="fl">0.120</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">65921</span>, <span class="sc">-</span><span class="fl">24.17</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(A) <span class="sc">%*%</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]
[1,]    -21038593
[2,] -57505488910</code></pre>
</div>
</div>
<div class="line-block">Note the inconsistency for the resulting thermodynamic parameters. The matrix solution by the <code>solve</code> command also suffers from solving the problem, incurring an error if executed, as in the following excerpt. Also note the distinct possibility for constructing the matrices.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>Aframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">3.67e-4</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="dv">328</span>, <span class="fl">0.120</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Aframe)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="dv">65921</span>, <span class="sc">-</span><span class="fl">24.17</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(A) <span class="sc">%*%</span> A) <span class="sc">%*%</span> <span class="fu">t</span>(A) <span class="sc">%*%</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="line-block">For these more complex situations, it may be useful to use <code>R</code> packages, such as <code>rootSolve</code> already used or <code>nleqslv</code> used previously. In this sense, the root search minimization for the system of equations can be demonstrated as follows:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimization for roots of a system of thermodynamic equations</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rootSolve)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">328</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">8.314</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fl">6.626e-34</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>kb <span class="ot">&lt;-</span> <span class="fl">1.381e-23</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>kcat <span class="ot">&lt;-</span> <span class="dv">217</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>DG <span class="ot">&lt;-</span> <span class="sc">-</span>R <span class="sc">*</span> T <span class="sc">*</span> <span class="fu">log</span>((kcat <span class="sc">*</span> h) <span class="sc">/</span> (kb <span class="sc">*</span> T)) <span class="co"># 65920 J/mol</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="dv">1</span>] <span class="sc">-</span> T <span class="sc">*</span> x[<span class="dv">2</span>] <span class="sc">-</span> DG, x[<span class="dv">2</span>] <span class="sc">/</span> R <span class="sc">-</span> x[<span class="dv">1</span>] <span class="sc">/</span> (R <span class="sc">*</span> T) <span class="sc">-</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>((kcat <span class="sc">*</span> h) <span class="sc">/</span> (kb <span class="sc">*</span> T)))</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>(ss <span class="ot">&lt;-</span> <span class="fu">multiroot</span>(model, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">50000</span>, <span class="dv">50000</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$root
[1] 40843.50837   -76.45441

$f.root
[1]  2.110028e-09 -7.744916e-13

$iter
[1] 3

$estim.precis
[1] 1.055401e-09</code></pre>
</div>
</div>
<div class="line-block">By this <em>numerical solution</em> the values ​​found for the parameters were <span class="math inline">\(\Delta\)</span> H<span class="math inline">\(^{\ddagger}\)</span> = 40.8 kJmol<span class="math inline">\(^{-1}\)</span> and <span class="math inline">\(\Delta\)</span> S<span class="math inline">\(^{\ddagger}\)</span> = -76.5 Jmol<span class="math inline">\(^{-1}\)</span>K<span class="math inline">\(^{-1}\)</span>.<br>
Comparing the values, the authors found <span class="math inline">\(\Delta\)</span> H<span class="math inline">\(^{\ddagger}\)</span> = 33.3 kJmol<span class="math inline">\(^{-1}\)</span> and <span class="math inline">\(\Delta\)</span> S<span class="math inline">\(^{\ddagger}\)</span> = -99.8 Jmol<span class="math inline">\(^{-1}\)</span>K<span class="math inline">\(^{-1}\)</span>. Note the similarity of the results obtained by minimizing roots with the parameters found by the authors. The value of <span class="math inline">\(\Delta\)</span> H<span class="math inline">\(^{\ddagger}\)</span> for these, however, was obtained only from obtaining the experimental value of <em>Arrhenius activation energy (Ea)</em>, by the slope of a linearized graph of the reaction rate, as follows:</div>
<p><span id="eq-Arrhenius"><span class="math display">\[
k = A *e^{-Ea/RT}
\\
ln(k) = \frac{\Delta S^{\ddagger}}{R} - \frac{\Delta H^{\ddagger}}{R} * \frac{1}{T}
\tag{14}\]</span></span></p>
<div class="line-block">Although a significant adequacy of the values ​​obtained by the authors and at a single temperature is noted, caution must be exercised with the procedure, since minimizations usually require good initialization seeds of the algorithm to produce good results. Furthermore, the very nature of the thermodynamic relationship between a reaction rate (such as <em>kcat</em>) and the resulting Gibbs energy change occurs on an exponential scale:</div>
<p><span id="eq-dGkcatRel"><span class="math display">\[
k = f(kcat) = e^{-\Delta G^{\ddagger}/RT}
\tag{15}\]</span></span></p>
<div class="line-block">This means in practice that small changes in <span class="math inline">\(\Delta\)</span> G<span class="math inline">\(^{\ddagger}\)</span> result in huge changes in the value of <em>k</em> (in this case, <em>kcat</em>). For this reason, small differences in the value of <span class="math inline">\(\Delta\)</span> G<span class="math inline">\(^{\ddagger}\)</span> can result in huge differences in <span class="math inline">\(\Delta\)</span> H<span class="math inline">\(^{\ddagger}\)</span> and <span class="math inline">\(\Delta\)</span> S<span class="math inline">\(^{\ddagger}\)</span> for the solution of the linear system. To illustrate this impact more directly, try changing the value of <span class="math inline">\(\Delta\)</span> G<span class="math inline">\(^{\ddagger}\)</span>, rounding it:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(rootSolve)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">328</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">8.314</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fl">6.626e-34</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>kb <span class="ot">&lt;-</span> <span class="fl">1.381e-23</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>kcat <span class="ot">&lt;-</span> <span class="dv">217</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>DG <span class="ot">&lt;-</span> <span class="dv">66000</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="dv">1</span>] <span class="sc">-</span> T <span class="sc">*</span> x[<span class="dv">2</span>] <span class="sc">-</span> DG, x[<span class="dv">2</span>] <span class="sc">/</span> R <span class="sc">-</span> x[<span class="dv">1</span>] <span class="sc">/</span> (R <span class="sc">*</span> T) <span class="sc">-</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>((kcat <span class="sc">*</span> h) <span class="sc">/</span> (kb <span class="sc">*</span> T)))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>(ss <span class="ot">&lt;-</span> <span class="fu">multiroot</span>(model, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">50000</span>, <span class="dv">50000</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$root
[1] 51579492242   157254348

$f.root
[1] 177.50881195  -0.09422566

$iter
[1] 3

$estim.precis
[1] 88.80152</code></pre>
</div>
</div>
</section>
<section id="enthalpy-of-reaction-by-matrices" class="level2">
<h2 class="anchored" data-anchor-id="enthalpy-of-reaction-by-matrices">Enthalpy of Reaction by Matrices</h2>
<div class="line-block">Chemical reactions are usually represented by the following equation:</div>
<p><span id="eq-eqReacGen"><span class="math display">\[
0 = \sum_{i=1}^{N} \nu_i B_i
\tag{16}\]</span></span></p>
<div class="line-block">Thus, if we observe the representations that accompany chemical reactions, we will see that they also constitute <em>linear functions</em>, as in the examples below:</div>
<p><span id="eq-eqReac"><span class="math display">\[
2 C_2H_2(g)+ 5 O_2(g) \rightleftarrows 4 CO_2(g) + 2 H_2O(l), \\
\Delta_fH^o = -2600 \,
kJ/mol\\
2 C_2H6(g) + 7 O_2(g) \rightleftarrows 4 CO_2(g) + 6 H_2O(l), \\
\; \Delta_fH^o = -3210 \, kJ/mol \\
H_2(g) + \frac{1}{2} O_2(g) \rightleftarrows H_2O(l), \\
; \Delta_fH^o = -286 \, kJ/mol\\
C_2H_2(g) + 2H_2(g) \rightleftarrows C_2H_6(g), \\
\; \Delta_fH^o = ?
\tag{17}\]</span></span></p>
<div class="line-block">And, if we select some reactions that have relationships between them, such as those presented in <a href="#eq-eqReac" class="quarto-xref">Equation&nbsp;17</a> above, we will then have a <em>system of linear equations</em>, capable of being solved by matrix algebra. This relationship between chemical reactions that involve the formation of compounds refers to <em>Hess’s Law</em>.<br>
Mathematically, <em>Hess’s Law</em> can be expressed as:</div>
<p><span id="eq-eqHess"><span class="math display">\[
\Delta_fH^o = \sum_{n=1}^{\infty} \nu \Delta_fH^o_P - \sum_{n=1}^{\infty} \nu \Delta_fH^o_R
\tag{18}\]</span></span></p>
<p>Where <span class="math inline">\(\nu\)</span> represents the <em>stoichiometry</em> of the reaction, that is, the number of <em>moles</em> of each compound/element, while <em>P</em> and <em>R</em> refer to the <em>Product</em> and <em>Reactant</em>.</p>
<div class="line-block">Returning to the <a href="#eq-eqReac" class="quarto-xref">Equation&nbsp;17</a> example, what we want is to obtain the value of the <em>reaction enthalpy</em> for ethane (<em><span class="math inline">\(C_2H_6\)</span></em>), based on the reaction enthalpy values ​​of the related species <span class="citation" data-cites="khalil2000calculating">(<a href="#ref-khalil2000calculating" role="doc-biblioref">Khalil 2000</a>)</span>. There are at least three possible solutions, in which the reaction enthalpy can be determined by the <em>bond enthalpy</em>, by the <em>formation enthalpy</em> itself, and by <em>Hess’s Law</em>, which can be calculated using matrices.<br>
To do this, it is necessary to 1) compose the matrices <em>A</em> and <em>b</em>, 2) calculate the vector of coefficients <em>beta</em>, and 3) perform the scalar product (%*%) of <em>beta</em> with a matrix formed by the formation enthalpy values. The rationale for composing the matrices involves listing each compound with its reaction stoichiometry, and requires that a negative value be given to <em>reactants</em>, while a positive value is given to products.<br>
The table below illustrates this construction for the problem in question.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># to generate the table</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C2H2"</span>, <span class="st">"O2"</span>, <span class="st">"CO2"</span>, <span class="st">"H2O"</span>, <span class="st">"C2H6"</span>, <span class="st">"H2"</span>) <span class="co"># list of compounds</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># involved</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>rea1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">+</span><span class="dv">4</span>, <span class="sc">+</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>) <span class="co"># stoichiometry (reaction1)</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>rea2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="sc">+</span><span class="dv">4</span>, <span class="sc">+</span><span class="dv">6</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>) <span class="co"># stoichiometry (reaction2)</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>rea3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="sc">+</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="co"># stoichiometry (reaction3)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>incog <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">+</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>) <span class="co"># stoichiometry of the reaction with enthalpy</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># unknown</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>tab_esteq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(comp, rea1, rea2, rea3, incog) <span class="co"># dataframe with the</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># results</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab_esteq) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"compound"</span>, <span class="st">"reaction 1"</span>, <span class="st">"reaction 2"</span>, <span class="st">"reaction 3"</span>,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="st">"ethane"</span>) <span class="co"># name the columns</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tab_esteq, <span class="at">caption =</span> <span class="st">"Reaction stoichiometry for a matrix solution of ethane formation (C2H6)."</span>, <span class="st">"pipe"</span>) <span class="co"># table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Reaction stoichiometry for a matrix solution of ethane formation (C2H6).</caption>
<thead>
<tr class="header">
<th style="text-align: left;">compound</th>
<th style="text-align: right;">reaction 1</th>
<th style="text-align: right;">reaction 2</th>
<th style="text-align: right;">reaction 3</th>
<th style="text-align: right;">ethane</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">C2H2</td>
<td style="text-align: right;">-2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">-1</td>
</tr>
<tr class="even">
<td style="text-align: left;">O2</td>
<td style="text-align: right;">-5</td>
<td style="text-align: right;">-7</td>
<td style="text-align: right;">-0.5</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">H2O</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C2H6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-2</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">H2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1.0</td>
<td style="text-align: right;">-2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="line-block">And the code snippet that follows calculates the value of <span class="math inline">\(\Delta H_r^o\)</span> for the formation of ethane.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix solution for enthalpy of formation</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">7</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">byrow =</span> T) <span class="co"># create matrix of reactions with known</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># enthalpy variation</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">byrow =</span> T) <span class="co"># create matrix of</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># stoichiometric coefficients of reaction with unknown</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># enthalpy variation</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(A) <span class="sc">%*%</span> A) <span class="sc">%*%</span> <span class="fu">t</span>(A) <span class="sc">%*%</span> b <span class="co"># beta calculation</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>energ <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2600</span>, <span class="sc">-</span><span class="dv">3210</span>, <span class="sc">-</span><span class="dv">286</span>), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> T) <span class="co"># create matrix</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># with enthalpy values</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>ethane <span class="ot">&lt;-</span> energ <span class="sc">%*%</span> beta</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Value for deltaHr ethane: "</span>, ethane, <span class="st">" kJ/mol"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Value for deltaHr ethane:  -267  kJ/mol</code></pre>
</div>
</div>
</section>
<section id="thermodynamic-quantities-by-polynomial-fit" class="level2">
<h2 class="anchored" data-anchor-id="thermodynamic-quantities-by-polynomial-fit">Thermodynamic Quantities by Polynomial Fit</h2>
<div class="line-block">As seen in the previous sections of this chapter and in the <em>Enzymes</em> chapter, <em>linear relations</em> allow the extraction of kinetic or thermodynamic parameters associated with biophysical-chemical phenomena, such as in the study of ligand associations with biopolymers, self-association of biomacromolecules, enzyme kinetics, or thermodynamic stability equilibrium of biopolymers. Regarding the latter, <a href="#eq-eqVHoff" class="quarto-xref">Equation&nbsp;10</a> illustrates the linear relationship between a thermodynamic parameter monitored during the experiment, such as <em><span class="math inline">\(K_{eq}\)</span></em> or <em><span class="math inline">\(\Delta\)</span>G</em>, and temperature (although other perturbations could also be viable, such as pH, denaturant content, ionic strength, etc.).<br>
However, we could not use linear matrix relationships or linear fits to solve quantitative parameters in situations that do not rely on linear behavior between variables, as reported by <a href="#eq-eqVHoff" class="quarto-xref">Equation&nbsp;10</a>, for example.</div>
<div class="line-block">To illustrate, the relationship between temperature and the value for <span class="math inline">\(\Delta\)</span>G of the self-association of apolipoprotein Apo A-II present in HDL lipoprotein does not exhibit a linear profile, and can be obtained from the literature with the help of the following code snippet: <span class="citation" data-cites="waelbroeck1979thermodynamics">(<a href="#ref-waelbroeck1979thermodynamics" role="doc-biblioref">Waelbroeck, Van Obberghen, and De Meyts 1979</a>)</span>.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dependence of T on deltaG for insulin and receptor</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.29</span>, <span class="fl">10.07</span>, <span class="fl">15.23</span>, <span class="fl">20.21</span>, <span class="fl">25.11</span>, <span class="fl">30.29</span>, <span class="fl">37.39</span>) <span class="sc">+</span> <span class="dv">273</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># temperature data, in degrees Kelvin</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>dG <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">11.74</span>, <span class="fl">12.17</span>, <span class="fl">12.46</span>, <span class="fl">12.73</span>, <span class="fl">12.88</span>, <span class="fl">12.98</span>, <span class="fl">13.13</span>) <span class="sc">*</span> <span class="sc">-</span><span class="fl">1e3</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># -deltaG data, in kcal/mol</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(T, dG,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="st">"T, K"</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(Delta, <span class="st">"G, kcal/mol"</span>))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-insuRec" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-insuRec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="biotermodin_en_files/figure-html/fig-insuRec-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-insuRec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Temperature dependence of the Gibbs energy change of the interaction of insulin with its receptor.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block"><a href="#fig-insuRec" class="quarto-xref">Figure&nbsp;1</a> shows a parabolic trend between the test temperature and the Gibbs energy variation of the process. Thus, a 3rd degree <em>polynomial</em> can be fitted to the data, as follows.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Polynomial fit of thermodynamic parameters</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>pol3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dG <span class="sc">~</span> <span class="fu">poly</span>(T, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>)) <span class="co"># fit to 3rd degree polynomial; # "raw=TRUE" is essential</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively, one can also fit polynomials as</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pol3&lt;-lm(dG ~ T + I(T^2)+I(T^3))</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pol3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dG ~ poly(T, 3, raw = TRUE))

Residuals:
      1       2       3       4       5       6       7 
  2.350 -13.432  26.731 -16.407  -8.577  12.164  -2.829 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)              8.970e+05  2.449e+05   3.663   0.0352 *
poly(T, 3, raw = TRUE)1 -8.836e+03  2.498e+03  -3.537   0.0385 *
poly(T, 3, raw = TRUE)2  2.866e+01  8.492e+00   3.375   0.0433 *
poly(T, 3, raw = TRUE)3 -3.105e-02  9.613e-03  -3.230   0.0482 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.6 on 3 degrees of freedom
Multiple R-squared:  0.999, Adjusted R-squared:  0.9981 
F-statistic:  1045 on 3 and 3 DF,  p-value: 5.02e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(T, dG,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="st">"T, K"</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(Delta, <span class="st">"G, kcal/mol"</span>))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># graph of T x deltaG</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(T, <span class="fu">fitted</span>(pol3), <span class="at">col =</span> <span class="st">"red"</span>) <span class="co"># curve fitted to the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-TdG" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-TdG-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="biotermodin_en_files/figure-html/fig-TdG-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-TdG-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Polynomial fit to the Gibbs energy variation data of the interaction of insulin with its receptor.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">Here it is worth mentioning that obtaining the parameters of a polynomial can also be validated with the help of linear algebra (matrices). For example, build the <em>matrix A</em> of the temperature values, and the <em>matrix b</em> of the values ​​of <span class="math inline">\(\Delta\)</span>G:</div>
<p><span class="math display">\[
A = \begin{bmatrix}
1 &amp; 278.29\\
1 &amp; 283.07\\
1 &amp; 288.23\\
1 &amp; 293.21\\
1 &amp; 298.11\\
1 &amp; 303.29\\
1 &amp; 310.39\\
\end{bmatrix} ,
\]</span> <span class="math display">\[
b = \begin{bmatrix}
-11740\\
-12170\\
-12460\\
-12730\\
-12880\\
-12980\\
-13130\\
\end{bmatrix}
\]</span></p>
<div class="line-block">In this case, the matrix operation takes into account the conversion of the matrix <em>A</em> of the independent variable into an <em>alternation matrix</em>, also known as <em>Vandermonde matrix</em>. A Vandermonde matrix is ​​presented as follows:</div>
<p><span class="math display">\[
matrix \,V = \begin{bmatrix}
1 &amp; x_1 &amp; x_1^2 &amp; x_1^3 &amp; ... \\
1 &amp; x_2 &amp; x_2^2 &amp; x_2^3 &amp; ... \\
1 &amp; x_3 &amp; x_3^2 &amp; x_3^3 &amp; ...\\
1 &amp; ...&amp; ... &amp; ... &amp; ...\\
\end{bmatrix} ,
\]</span></p>
<div class="line-block">An apparent limitation of this procedure is that the adjustment must be performed with few experimental points, since the exponential term grows with the number of points. On the other hand, the matrix solution circumvents the need to obtain statistical sums of the variables. <code>R</code> has a package to automate this transformation, <code>matrixcalc</code>, exemplified in the code snippet below:<br>
Now just apply the same matrix relation of <a href="#eq-eqAm1xb" class="quarto-xref">Equation&nbsp;8</a>, in this case, for four interleaved points of the experimental data above, and therefore producing a 4th degree polynomial:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Polynomial adjustment 4th degree for thermodynamic parameters</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.29</span>, <span class="fl">15.23</span>, <span class="fl">25.11</span>, <span class="fl">37.39</span>) <span class="sc">+</span> <span class="dv">273</span> <span class="co"># temperature data,</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># in degrees Kelvin</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>dG <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">11.74</span>, <span class="fl">12.46</span>, <span class="fl">12.88</span>, <span class="fl">13.13</span>) <span class="sc">*</span> <span class="sc">-</span><span class="fl">1e3</span> <span class="co">#</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixcalc)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating matrices A (Vandermonde) and b</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dG, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="co"># vector b</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">vandermonde.matrix</span>(<span class="at">alpha =</span> T, <span class="at">n =</span> <span class="dv">4</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>A <span class="co"># function to create alternation matrix (Vandermonde)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]   [,2]     [,3]     [,4]
[1,]    1 278.29 77445.32 21552259
[2,]    1 288.23 83076.53 23945149
[3,]    1 298.11 88869.57 26492908
[4,]    1 310.39 96341.95 29903579</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>sol.vnd <span class="ot">&lt;-</span> <span class="fu">solve</span>(A) <span class="sc">%*%</span> b</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>sol.vnd <span class="co"># polynomial coefficients (4th degree)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]
[1,]  5.095658e+05
[2,] -4.886799e+03
[3,]  1.525183e+01
[4,] -1.589352e-02</code></pre>
</div>
</div>
<div class="line-block">To plot the data, simply convert the polynomial coefficients above into the resulting polynomial expression, which can be done with the <code>polynom</code> package:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(polynom) <span class="co"># converts vector of coefficients into symbolic polynomial</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as.polynomial</span>(sol.vnd)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">as.function</span>(p) <span class="co"># allows converting the polynomial to the curve function</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(T, dG)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(p2, <span class="at">from =</span> <span class="dv">273</span>, <span class="at">to =</span> <span class="dv">315</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) <span class="co"># smooth polynomial curve</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="biotermodin_en_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="line-block">Although the polynomial fit, either by the <code>R</code> eigenfunction (<code>lm</code>) or by the matrix solution above, reveals good adherence of the model to the experimental data, as represented by <a href="#fig-TdG" class="quarto-xref">Figure&nbsp;2</a> and the results table above, there is no correlation of thermodynamic parameters, since it is an empirical mathematical model, and not an analytical one for the system.<br>
However, it is possible to obtain a good approximation of the quantities <span class="math inline">\(\Delta\)</span>H (enthalpy), <span class="math inline">\(\Delta\)</span>S (entropy) and <span class="math inline">\(\Delta\)</span>Cp (heat capacity) that phenomenologically model the thermodynamic behavior at a given temperature, by specific relations between these quantities <span class="citation" data-cites="edelhoch1976thermodynamic">(<a href="#ref-edelhoch1976thermodynamic" role="doc-biblioref">Edelhoch and Osborne Jr 1976</a>)</span>.</div>
<p><span id="eq-eqdS"><span class="math display">\[
\Delta S = -(\frac{\partial \Delta G}{\partial T})_p
\tag{19}\]</span></span></p>
<div class="line-block">In short, the variation of entropy can be defined as the gradient of the variation of Gibbs energy with temperature. Another way of saying it would be to state that the entropy variation can also be defined as the first derivative of that relation, which can be defined empirically by:</div>
<p><span id="eq-eqGibbsEmp"><span class="math display">\[
\Delta G = a+bT+cT^2+dT^3
\tag{20}\]</span></span></p>
<p>Thus, the value of <span class="math inline">\(\Delta\)</span>S can be obtained by the first derivative of the empirical relation above (<a href="#eq-eqGibbsEmp" class="quarto-xref">Equation&nbsp;20</a>):</p>
<p><span id="eq-eqdSEmp"><span class="math display">\[
\Delta S = -(\frac{\partial \Delta G}{\partial T})_p = -b-2cT-3dT^2
\tag{21}\]</span></span></p>
<p>The value of <span class="math inline">\(\Delta\)</span>H, in turn, can now be extracted from the <a href="#eq-eqGibbs" class="quarto-xref">Equation&nbsp;22</a> repeated here, together with the <a href="#eq-eqGibbsEmp" class="quarto-xref">Equation&nbsp;20</a>:</p>
<p><span id="eq-eqGibbs"><span class="math display">\[
\Delta G = \Delta H - T * \Delta S
\tag{22}\]</span></span></p>
<p><span id="eq-eqdH"><span class="math display">\[
\Delta H = \Delta G +T * \Delta S
\tag{23}\]</span></span></p>
<div class="line-block">Applying the empirical equations for the thermodynamic parameters above:</div>
<p><span id="eq-eqdHEmp"><span class="math display">\[
\Delta H = (a+bT+cT^2+dT^3) +T(-b-2cT-3dT^2)
\tag{24}\]</span></span></p>
<p><span id="eq-eqdHEmp2"><span class="math display">\[
\Delta H = a-cT^2-2dT^3
\tag{25}\]</span></span></p>
<div class="line-block">Similarly, the <em>heat capacity</em> at constant pressure can be defined as:</div>
<p><span id="eq-eqdCp"><span class="math display">\[
\Delta Cp = -(\frac{\partial \Delta H}{\partial T})_p
\tag{26}\]</span></span></p>
<p>That is, the value of <span class="math inline">\(\Delta\)</span>Cp can be approximated by the first derivative of <span class="math inline">\(\Delta\)</span>H (<a href="#eq-eqdHEmp" class="quarto-xref">Equation&nbsp;24</a>) over T. That is:</p>
<p><span id="eq-eqdCpEmp"><span class="math display">\[
\Delta Cp = -2cT-6dT^2
\tag{27}\]</span></span></p>
<div class="line-block">Although they are approximations, the thermodynamic parameters thus obtained reflect the possibility of describing a phenomenon, such as the interaction of insulin with its receptor (<span class="citation" data-cites="waelbroeck1979thermodynamics">Waelbroeck, Van Obberghen, and De Meyts (<a href="#ref-waelbroeck1979thermodynamics" role="doc-biblioref">1979</a>)</span>), from the perspective of preponderant weak bonds, such as hydrogen bonds, van der Waals forces, salt effect, electrostatic interactions and hydrophobic effect <span class="citation" data-cites="ross1981thermodynamics">(<a href="#ref-ross1981thermodynamics" role="doc-biblioref">Ross and Subramanian 1981</a>)</span>, only by monitoring an equilibrium constant with temperature. The code snippet below solves the thermodynamic parameters for the complexation of insulin with its receptor at 25<span class="math inline">\(^o\)</span>C by the method described.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Polynomial solution of thermodynamic parameters for interaction of</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># insulin with receptor</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.29</span>, <span class="fl">10.07</span>, <span class="fl">15.23</span>, <span class="fl">20.21</span>, <span class="fl">25.11</span>, <span class="fl">30.29</span>, <span class="fl">37.39</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="dv">273</span> <span class="co"># temperature data, in degrees Kelvin</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>dG <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">11.74</span>, <span class="fl">12.17</span>, <span class="fl">12.46</span>, <span class="fl">12.73</span>, <span class="fl">12.88</span>, <span class="fl">12.98</span>, <span class="fl">13.13</span>) <span class="sc">*</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">1e3</span> <span class="co"># -deltaG data, in kcal/mol</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit to 2nd degree polynomial</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>pol3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dG <span class="sc">~</span> <span class="fu">poly</span>(T, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>)) <span class="co"># fit to 3rd degree polynomial degree</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>Tref <span class="ot">&lt;-</span> <span class="dv">298</span> <span class="co"># reference temperature, in degrees Kelvin</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculations</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>dG <span class="ot">&lt;-</span> <span class="fu">coef</span>(pol3)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(pol3)[<span class="dv">2</span>] <span class="sc">*</span> Tref <span class="sc">+</span> <span class="fu">coef</span>(pol3)[<span class="dv">3</span>] <span class="sc">*</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>Tref<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">coef</span>(pol3)[<span class="dv">4</span>] <span class="sc">*</span> Tref<span class="sc">^</span><span class="dv">3</span> <span class="co"># deltaG</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>dS <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">coef</span>(pol3)[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">coef</span>(pol3)[<span class="dv">3</span>] <span class="sc">*</span> Tref <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">coef</span>(pol3)[<span class="dv">4</span>] <span class="sc">*</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>Tref<span class="sc">^</span><span class="dv">2</span> <span class="co"># deltaS</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>dH <span class="ot">&lt;-</span> <span class="fu">coef</span>(pol3)[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">coef</span>(pol3)[<span class="dv">3</span>] <span class="sc">*</span> Tref<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">coef</span>(pol3)[<span class="dv">4</span>] <span class="sc">*</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>Tref<span class="sc">^</span><span class="dv">3</span> <span class="co"># deltaH</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>dCp <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">coef</span>(pol3)[<span class="dv">3</span>] <span class="sc">*</span> Tref <span class="sc">-</span> <span class="dv">6</span> <span class="sc">*</span> <span class="fu">coef</span>(pol3)[<span class="dv">4</span>] <span class="sc">*</span> Tref<span class="sc">^</span><span class="dv">2</span> <span class="co"># deltaCp</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters in 298 K</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"deltaG value: "</span>, dG, <span class="st">"cal/mol"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>deltaG value:  -12868.43 cal/mol </code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"deltaS value: "</span>, dS, <span class="st">"cal/mol/K"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>deltaS value:  27.29257 cal/mol/K </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"deltaH value: "</span>, dH, <span class="st">"cal/mol"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>deltaH value:  -4735.248 cal/mol </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"deltaCp value: "</span>, dCp, <span class="st">"cal/mol/K"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>deltaCp value:  -537.5956 cal/mol/K </code></pre>
</div>
</div>
<div class="line-block">The values ​​found for the interaction are very close to those reported by the authors at 25<span class="math inline">\(^o\)</span>C (<span class="citation" data-cites="waelbroeck1979thermodynamics">Waelbroeck, Van Obberghen, and De Meyts (<a href="#ref-waelbroeck1979thermodynamics" role="doc-biblioref">1979</a>)</span>), although they used a fit with a 2nd degree polynomial. If you change the code snippet above to a polynomial of the same degree and omit the terms of the thermodynamic equations that identify the coefficient <em>d</em>, a value of <span class="math inline">\(\Delta\)</span>Cp of -735 kcal/mol should be observed, very similar to the reported value of -766 kcal/mol.</div>
</section>
<section id="thermodynamic-stability-of-biopolymers" class="level2">
<h2 class="anchored" data-anchor-id="thermodynamic-stability-of-biopolymers">Thermodynamic Stability of Biopolymers</h2>
<div class="line-block">The thermodynamic stability of proteins, enzymes and nucleic acids is essential for the study of new engineered biopolymers, modified complex matrices (artificial plasma, for example), as well as for the research of drug and medicine candidates. In general terms, the biopolymer under evaluation is considered in a <em>two-state model</em>, <em>native</em> and <em>denatured</em>, as presented in the <a href="#eq-eqKeq" class="quarto-xref">Equation&nbsp;3</a> of this chapter.</div>
<div class="line-block">However, as the experimental determination of <em>[N]</em> and <em>[D]</em> concentrations becomes complex, we seek to obtain a relationship between them, specifically, their fraction, such that:</div>
<p><span id="eq-eqfDfN"><span class="math display">\[
f_D+f_N = 1
\tag{28}\]</span></span></p>
<p>Which results in:</p>
<p><span id="eq-eqSfD"><span class="math display">\[
f_N = 1 - f_D
\tag{29}\]</span></span></p>
<div class="line-block">Thus, an experimental signal <em>S</em> obtained in the presence of <em>N</em> and <em>D</em> fractions in a biopolymer sample can be represented as:</div>
<p><span id="eq-eqS"><span class="math display">\[
S = f_N * S_N +f_D * S_D
\tag{30}\]</span></span></p>
<div class="line-block">Substituting <a href="#eq-eqSfD" class="quarto-xref">Equation&nbsp;29</a> in <a href="#eq-eqS" class="quarto-xref">Equation&nbsp;30</a> we obtain:</div>
<p><span id="eq-eqfD"><span class="math display">\[
f_D = \frac{S_i-S_N}{S_D-S_N}
\tag{31}\]</span></span></p>
<p>Where <em>Si</em> represents the signal at point <em>i</em>.</p>
<div class="line-block">Thus, even if the concentrations <em>[N]</em> and <em>[D]</em> are not directly obtained, their fractions can be recovered from the signal obtained from denaturation tests against various perturbants, such as temperature, pH, salts or denaturing reagents (urea, guanidine chloride, for example).</div>
<div class="line-block">In this way, the value of the equilibrium thermodynamic constant of denaturation K<span class="math inline">\(_D\)</span> can also be recovered, such that:</div>
<p><span id="eq-eqKD"><span class="math display">\[
K_D = \frac{[D]}{[N]}=\frac{f_D}{f_N}
\tag{32}\]</span></span></p>
<div class="line-block">Inserting <a href="#eq-eqSfD" class="quarto-xref">Equation&nbsp;29</a> into <a href="#eq-eqKD" class="quarto-xref">Equation&nbsp;32</a>, we obtain:</div>
<p><span id="eq-eqKD2"><span class="math display">\[
K_D = \frac{f_D}{1-f_D}
\tag{33}\]</span></span></p>
<p>And, therefore,</p>
<p><span id="eq-eqdGD"><span class="math display">\[
\Delta G_D = -RT*ln\;K_D
\tag{34}\]</span></span></p>
<div class="line-block">In this way, it is possible to evaluate the thermodynamic stability of a biopolymer by its <em>stability curve</em>, contrasting the <em>perturbant</em> against the value of <em><span class="math inline">\(\Delta\)</span>G<span class="math inline">\(_D\)</span></em> obtained by the above procedures.</div>
<div class="line-block">Analytically, a stability curve can be generated from the constant parameters in the <em>integrated Gibbs-Helmholtz equation</em> (<span class="citation" data-cites="licata2011analysis">LiCata and Liu (<a href="#ref-licata2011analysis" role="doc-biblioref">2011</a>)</span>):</div>
<p><span id="eq-eqGibHelm"><span class="math display">\[
\Delta G(T) = \Delta H_m(\frac{Tm-T}{Tm})-\Delta Cp[Tm-T(1-ln \; \frac{Tm}{T})])
\tag{35}\]</span></span></p>
<div class="line-block">Thus, a stability curve can be illustrated by the following code snippet:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Denaturation curve for protein</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>Tm <span class="ot">&lt;-</span> <span class="dv">85</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>dHm <span class="ot">&lt;-</span> <span class="dv">180</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>dCp <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">80</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(dHm <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x <span class="sc">/</span> Tm) <span class="sc">+</span> dCp <span class="sc">*</span> ((x <span class="sc">-</span> Tm <span class="sc">-</span> x <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">/</span> Tm)))</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>)) <span class="co"># Nicholson1996; Sholz2009</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="biotermodin_en_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Simulated stability curve for the denaturation of a protein. Tm = 75oC, DeltaHm = 180 kcal/mol, and DeltaCp = 3 kcal/mol/K.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="quantitative-structure-function-relationship-qsar-and-multilinear-fitting" class="level2">
<h2 class="anchored" data-anchor-id="quantitative-structure-function-relationship-qsar-and-multilinear-fitting">Quantitative Structure-Function Relationship (QSAR) and Multilinear Fitting</h2>
<div class="line-block">The same procedures employed to solve matrix problems, specifically with <a href="#eq-linMatr" class="quarto-xref">Equation&nbsp;11</a>, can also accommodate a QSAR (Quantitative Structure-Function Relationship) analysis of interest. For example, benzodiazepinone derivatives (TIBO) are known to inhibit reverse transcriptase <span class="citation" data-cites="tong2018qsar">(<a href="#ref-tong2018qsar" role="doc-biblioref">Tong et al. 2018</a>)</span>, an enzyme that catalyzes the conversion of RNA into viral DNA in acquired immune deficiency syndrome (AIDS). In this sense, observations derived from the QSAR study can contribute to the design of potential HIV transcriptase inhibitors. Thus, Tong et al.&nbsp;proposed a multilinear predictive model relating some properties of TIBO analogues with biological activity, as follows:</div>
<p><span class="math display">\[
pIC_{50}=x_0+x_1*S+x_2*W
\]</span> {#eq:eqTIBO}</p>
<p>Where <em>pIC<span class="math inline">\(_{50}\)</span></em> represents the measured biological activity (<em>-log IC<span class="math inline">\(_{50}\)</span></em>), <em>S</em> indexes solubility values, and <em>W</em> refers to the width parameter of the first atom of the substituent group. These data are tabulated below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabulation data for QSAR</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"H"</span>, <span class="st">"Cl"</span>, <span class="st">"SCH3"</span>, <span class="st">"OCH3"</span>, <span class="st">"CN"</span>, <span class="st">"CHO"</span>, <span class="st">"Br"</span>, <span class="st">"CH3"</span>, <span class="st">"CCH"</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># substituent groups in TIBO</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.53</span>, <span class="fl">4.24</span>, <span class="fl">4.09</span>, <span class="fl">3.45</span>, <span class="fl">2.96</span>, <span class="fl">2.89</span>, <span class="fl">4.39</span>, <span class="fl">4.03</span>, <span class="fl">3.8</span>) <span class="co"># solubility parameter</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.8</span>, <span class="fl">1.7</span>, <span class="fl">1.35</span>, <span class="fl">1.6</span>, <span class="fl">1.6</span>, <span class="fl">1.95</span>, <span class="fl">1.6</span>, <span class="fl">1.6</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># group width parameter</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>pIC50 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">7.36</span>, <span class="fl">8.37</span>, <span class="fl">8.3</span>, <span class="fl">7.47</span>, <span class="fl">7.25</span>, <span class="fl">6.73</span>, <span class="fl">8.52</span>, <span class="fl">7.87</span>, <span class="fl">7.53</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co"># biological activity of TIBO</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>tab.tibo <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(group, S, W, pIC50)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tab.tibo, <span class="at">caption =</span> <span class="st">"multivariate data of biological activity of TIBO and predictive parameters."</span>, <span class="st">"pipe"</span>) <span class="co"># table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>multivariate data of biological activity of TIBO and predictive parameters.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">group</th>
<th style="text-align: right;">S</th>
<th style="text-align: right;">W</th>
<th style="text-align: right;">pIC50</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">H</td>
<td style="text-align: right;">3.53</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">7.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cl</td>
<td style="text-align: right;">4.24</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">8.37</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SCH3</td>
<td style="text-align: right;">4.09</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">8.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">OCH3</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">7.47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CN</td>
<td style="text-align: right;">2.96</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">7.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">CHO</td>
<td style="text-align: right;">2.89</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">6.73</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Br</td>
<td style="text-align: right;">4.39</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">8.52</td>
</tr>
<tr class="even">
<td style="text-align: left;">CH3</td>
<td style="text-align: right;">4.03</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">7.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CCH</td>
<td style="text-align: right;">3.80</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">7.53</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="line-block">Note that there are two predictor variables and one dependent variable, and whose solution can be found by <em>multilinear or multiple linear fit</em>. <code>R</code> allows this to be done in at least two ways: internal linear fit function (<code>lm</code>) or matrix algebra.</div>
<section id="multiple-linear-fit-by-lm-function" class="level3">
<h3 class="anchored" data-anchor-id="multiple-linear-fit-by-lm-function">Multiple linear fit by <code>lm</code> function:</h3>
<div class="line-block">In a simplified way, one can obtain the multivariate expression that defines the relationship of the predictive quantities <em>W</em> and <em>S</em> with the biological activity of TIBO by:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multilinear fitting in QSAR</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>lm.tibo <span class="ot">&lt;-</span> <span class="fu">lm</span>(tab.tibo<span class="sc">$</span>pIC50 <span class="sc">~</span> tab.tibo<span class="sc">$</span>S <span class="sc">+</span> tab.tibo<span class="sc">$</span>W)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># command for multilinear fitting;</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternatively,</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># lm.tibo &lt;- lm(cbind(S,W)~pIC50)</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.tibo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tab.tibo$pIC50 ~ tab.tibo$S + tab.tibo$W)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27636 -0.15649  0.02922  0.08911  0.24761 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.5903     0.5435   6.606 0.000579 ***
tab.tibo$S    0.9571     0.1519   6.300 0.000746 ***
tab.tibo$W    0.3619     0.3020   1.199 0.275888    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2045 on 6 degrees of freedom
Multiple R-squared:  0.912, Adjusted R-squared:  0.8826 
F-statistic: 31.07 on 2 and 6 DF,  p-value: 0.0006826</code></pre>
</div>
</div>
<div class="line-block">Note the most direct way to assign already declared variables to an <code>R</code> function (*dataframe $ vector). This is the simplest way, since it does not depend on extra packages (like <code>dplyr</code>), although it is less readable.</div>
<div class="line-block">Expressing the results in multiple linear function:</div>
<p><span id="eq-eqTIBO2"><span class="math display">\[
y=5.75+0.14*S+0.95*W
\tag{36}\]</span></span></p>
</section>
<section id="multiple-linear-adjustment-by-matrices" class="level3">
<h3 class="anchored" data-anchor-id="multiple-linear-adjustment-by-matrices">Multiple linear adjustment by matrices:</h3>
<div class="line-block">The <em>beta</em> coefficients obtained above can also be found by linear algebra, using the <em>b</em> biological activity matrix and the <em>A</em> matrix containing the independent variables, this one also created with unit values ​​on the left, as before, followed by the application of <a href="#eq-linMatr" class="quarto-xref">Equation&nbsp;11</a>:</div>
<p><span class="math display">\[
X = \begin{bmatrix}
1 &amp; S_{1} &amp; W_{1} \\
1 &amp; S_{2} &amp; W_{2}\\
1 &amp; S_{3} &amp; W_{3}\\
... &amp; ...
\end{bmatrix}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating matrices A and b</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>), S, W), <span class="at">nrow =</span> <span class="dv">9</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># creates matrix with unit value required before the independent variable</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pIC50, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>) <span class="co"># vector b</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix solution of linear adjustment</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(A) <span class="sc">%*%</span> A) <span class="sc">%*%</span> <span class="fu">t</span>(A) <span class="sc">%*%</span> b</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>beta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 3.5902556
[2,] 0.9571092
[3,] 0.3619292</code></pre>
</div>
</div>
<div class="line-block">Note that the values ​​for the coefficients are coincident. In practice, the multiple linear adjustment procedure can be used, as in the example above, to predict a response (such as pIC<span class="math inline">\(_{50}\)</span>) as a function of predictor variables (such as S and W).<br>
This multilinear matrix procedure can also be applied to other types of multivariate analysis, such as <em>factorial experiment</em> and <em>response surface methodology</em>. This is due to the very nature of these systems, when linear. See the applications below. Even for <em>quadratic response surface methodology</em> (where the parameters vary with the square of the predictor variables), the matrix solution (<a href="#eq-linMatr" class="quarto-xref">Equation&nbsp;11</a>) is also possible.</div>
<p><span id="eq-eqsLineares"><span class="math display">\[
y = b_0+b_1*x, \, linear fit\
\\
y = b_0+b_1*x_1+b_2*x_2+...+b_n*x_n, \, fit \, multilinear
\\
y = b_0+b_1*x_1+b_2*x_2+...+b_n*x_n, \, methodology \, of \, surface \, of \, response \, linear
\\
y = b_0+b_1*x_1+b_2*x_2+b_{12}*x_1*x_2, \, planning \, factorial \, 2^2
\\
y = b_0+b_1*x_1+b_2*x_2+b_3*x_3+b_{12}*x_1*x_2+,b_{13}*x_1*x_3+b_{23}*x_2*x_3+b_{123}*x_1*x_2*x3 \, experiment \, factorial \, 2^3
\\
y = b_0+b_1*x_1+b_2*x_2+b_{11}*x_1^2+b_{22}*x_2^2+b_{12}*x_1*x_2, \, quadratic \, response \, surface \, methodology
\\
\tag{37}\]</span></span></p>
<div class="line-block">As a rule, all applications listed in <a href="#eq-eqsLineares" class="quarto-xref">Equation&nbsp;37</a> can be solved with the help of matrix relations of the equations <a href="#eq-linMatr" class="quarto-xref">Equation&nbsp;11</a> (linear, multilinear and linear response surface adjustments) or <a href="#eq-eqAxb" class="quarto-xref">Equation&nbsp;7</a> (factorial designs). Two situations of this nature are exemplified below.</div>
</section>
<section id="a-word-about-matrices-and-applications" class="level3">
<h3 class="anchored" data-anchor-id="a-word-about-matrices-and-applications">A word about matrices and applications</h3>
<div class="line-block">As already noted, the use of matrices extends to various situations, not necessarily of a Biochemical or Biophysical nature, data adjustments, Hess’s or Lambert-Beer’s Law, as well as the construction of a menu (matrix of ingredients for each dish by price of each ingredient), or the daily caloric expenditure in physical activity (matrix of weekly workload of each activity by matrix of caloric expenditure of the activity). In fact, they are tools used in Bioinformatics, Economics, Ecology, Engineering, and many other areas, satisfying the basic relations between the variables under study. These conditions, in turn, represent nothing more than <em>the sum of products</em>, in which these are manifested by quantities declared in the problem. Thus, a small representation of the statement above could be illustrated simply as:</div>
<p><span id="eq-soulMatrix"><span class="math display">\[
y = \sum_{n=1}^{\infty} (x_1*x_2)
\tag{38}\]</span></span></p>



</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bhatti2007effect" class="csl-entry" role="listitem">
Bhatti, Haq Nawaz, M Hamid Rashid, Rakhshanda Nawaz, A Mukhtar Khalid, Muhammad Asgher, and A Jabbar. 2007. <span>“Effect of Aniline Coupling on Kinetic and Thermodynamic Properties of Fusarium Solani Glucoamylase.”</span> <em>Applied Microbiology and Biotechnology</em> 73 (6): 1290–98.
</div>
<div id="ref-cooper2004thermodynamics" class="csl-entry" role="listitem">
Cooper, Alan. 2004. <span>“Thermodynamics and Interactions.”</span> In <em>Biophysical Chemistry</em>, 99–122.
</div>
<div id="ref-edelhoch1976thermodynamic" class="csl-entry" role="listitem">
Edelhoch, Harold, and James C Osborne Jr. 1976. <span>“The Thermodynamic Basis of the Stability of Proteins, Nucleic Acids, and Membranes.”</span> <em>Advances in Protein Chemistry</em> 30: 183–250.
</div>
<div id="ref-khalil2000calculating" class="csl-entry" role="listitem">
Khalil, Mutasim I. 2000. <span>“Calculating Enthalpy of Reaction by a Matrix Method.”</span> <em>Journal of Chemical Education</em> 77 (2): 185.
</div>
<div id="ref-licata2011analysis" class="csl-entry" role="listitem">
LiCata, Vince J, and Chin-Chi Liu. 2011. <span>“Analysis of Free Energy Versus Temperature Curves in Protein Folding and Macromolecular Interactions.”</span> <em>Methods in Enzymology</em> 488: 219–38.
</div>
<div id="ref-ross1981thermodynamics" class="csl-entry" role="listitem">
Ross, Philip D, and S Subramanian. 1981. <span>“Thermodynamics of Protein Association Reactions: Forces Contributing to Stability.”</span> <em>Biochemistry</em> 20 (11): 3096–3102.
</div>
<div id="ref-tong2018qsar" class="csl-entry" role="listitem">
Tong, Jianbo, Shan Lei, Shangshang Qin, and Yang Wang. 2018. <span>“QSAR Studies of TIBO Derivatives as HIV-1 Reverse Transcriptase Inhibitors Using HQSAR, CoMFA and CoMSIA.”</span> <em>Journal of Molecular Structure</em> 1168: 56–64.
</div>
<div id="ref-waelbroeck1979thermodynamics" class="csl-entry" role="listitem">
Waelbroeck, Magali, E Van Obberghen, and P De Meyts. 1979. <span>“Thermodynamics of the Interaction of Insulin with Its Receptor.”</span> <em>Journal of Biological Chemistry</em> 254 (16): 7736–40.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>