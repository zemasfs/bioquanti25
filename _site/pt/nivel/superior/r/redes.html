<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.22">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Redes Metabólicas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../avatar.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-7b4406b7675125bc2ba204020e191172.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-4b957b30fffc5edb70387ff4d75203a6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-S1L73VGCG5"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-S1L73VGCG5', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../logo-unifal.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Procurar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Alternar de navegação" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Sobre</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../erre.html"> 
<span class="menu-text">Ensino Reprodutível</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-folhas-de-dicas" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Folhas de dicas</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-folhas-de-dicas">    
        <li>
    <a class="dropdown-item" href="../../../cheatsheet/plotly.pdf">
 <span class="dropdown-text">Plotly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../cheatsheet/jmol_cheat.pt2.pdf">
 <span class="dropdown-text">Jmol</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../cheatsheet/r_cheat.pt.pdf">
 <span class="dropdown-text">R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../producao.html"> 
<span class="menu-text">Trabalhos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../contato.html"> 
<span class="menu-text">Contato</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../en/index.html"> 
<span class="menu-text">EN</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo de leitor">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Redes Metabólicas</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">JSPlotly &amp; GSPlotly - Simulação gráfica interativa &amp; IA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/jsplotly/jsplotly_geral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">JSPlotly - Simulação gráfica com JavaScript</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/jsplotly/gsplotly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GSPlotly - gerador de códigos por IA para JSPlotly</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/jsplotly/jsplt_bioq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulações em Biofísico-química</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/jsplotly/jsplotly_bas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulações na Escola</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Jmol - Moléculas em 3D</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/jmol/index_jmol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelos atômicos em Bioquímica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/Curso/index_jmol_bas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Moléculas 3D na Escola</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/Jardim/index_Jardim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Jardim de Moléculas</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">R - Cálculos e visualizações</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/r/index_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R em Biofísico-química</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/ScriptRplot/scriptrplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">scriptRplot: gráficos elegantes com ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/Curso/index_r_bas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R &amp; RStudio na Escola</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/R/index_OIER.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gráficos e mapas interativos na Escola</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Sisma - diagramas dinâmicos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/superior/sisma/index_sisma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fluxos dinâmicos em Bioquímica</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../nivel/basico/sisma/index_sisma_bas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diagramas interativos na Escola</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Nesta página</h2>
   
  <ul>
  <li><a href="#redesMet" id="toc-redesMet" class="nav-link active" data-scroll-target="#redesMet">Vias bioquímicas do metabolismo</a></li>
  <li><a href="#solução-numérica-para-sistema-de-equações-diferenciais" id="toc-solução-numérica-para-sistema-de-equações-diferenciais" class="nav-link" data-scroll-target="#solução-numérica-para-sistema-de-equações-diferenciais">Solução numérica para sistema de equações diferenciais</a></li>
  <li><a href="#algumas-reações-do-metabolismo-da-glicose" id="toc-algumas-reações-do-metabolismo-da-glicose" class="nav-link" data-scroll-target="#algumas-reações-do-metabolismo-da-glicose">Algumas reações do metabolismo da glicose</a></li>
  <li><a href="#cinética-do-metabolismo-de-6-mercaptopurina" id="toc-cinética-do-metabolismo-de-6-mercaptopurina" class="nav-link" data-scroll-target="#cinética-do-metabolismo-de-6-mercaptopurina">Cinética do metabolismo de 6-mercaptopurina</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Redes Metabólicas</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="redesMet" class="level2">
<h2 class="anchored" data-anchor-id="redesMet">Vias bioquímicas do metabolismo</h2>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Podemos considerar o metabolismo celular como uma rede de vias metabólicas retroalimentadas homeostaticamente. Se observarmos com ampliação qualquer uma das reações bioquímicas envolvidas nessa teia complexo, poderemos identificar uma <em>caixa preta</em> comum a todas:</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/blackbox.png" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption>Uma representação da caixa preta de reações enzimáticas. E = enzima c,d = cofatores, coenzimas, modificadores; f,g = compostos secundários resultantes da catálise .</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ainda que a representação acima possa envolver reações em equilíbrio (duplas setas), ou mesmo a ausência do catalisador, a imagem generaliza reações bioquímicas individuais partícipes de qualquer <em>mapa metabólico</em>. Se desejarmos agora avaliar o consumo do composto <em>A</em> (reagente, substrato) e resultante formação do composto <em>B</em> (produto), ou seja, os teores dos compostos num intervalo de tempo, podemos considerar, como visto no capítulo de <em>Enzimas</em>), a reação acima como de 1a. ordem em ambos, reagente e produto:</div>
<p><span id="eq-ABirrev"><span class="math display">\[
A
\begin{array}{c}
_{k}\\
\rightarrow \\
  ^{}\end{array} B
  \tag{1}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dessa forma, pode-se considerar a velocidade de reação como a variação de <em>A</em> ou <em>B</em> no tempo como:</div>
<p><span id="eq-dydx"><span class="math display">\[
v=\frac{dy}{dx}=-\frac{dA}{dt}=\frac{dB}{dt}
\tag{2}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;Ou seja, quando há consumo, a taxa de variação apresenta-se negativa, e quando há formação, positiva. Separando as duas taxas:</div>
<p><span id="eq-dAdt"><span class="math display">\[
\frac{dA}{dt}= -k*A;\\
\frac{db}{dt} = k*B
\tag{3}\]</span></span></p>
<div class="line-block">E dessa forma, para se calcular a variação em cada composto ao longo de um intervalo de tempo:</div>
<p><span id="eq-dAdB"><span class="math display">\[
dA=-k*A*dt;\\
dB=k*A*dt
\tag{4}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Observe que estamos diante de um <em>sistema de equações diferenciais</em>, nominalmente <em>ordinárias</em>, já que as alterações no tempos ocorrem um função de um único parâmetro (concentração das espécies). Caso constituisse de um sistema dependente em mais de um parâmetro, estaríamos tratando de equações diferenciais <em>parciais</em> (comuns nas relações termodinâmicas que envolvem modificações com variação de volume, temperatura, e pressão).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Algumas equações diferenciais podem ser analiticamente resolvidas, como as que envolvem o crescimento exponencial bacteriano:</div>
<p><span id="eq-expDecay"><span class="math display">\[
\frac{dN}{dt}=-k*N; \, N(t) = N_0*e^{-kt}; (N=N_0 \,em \, t=0)
\tag{5}\]</span></span></p>
</section>
<section id="solução-numérica-para-sistema-de-equações-diferenciais" class="level2">
<h2 class="anchored" data-anchor-id="solução-numérica-para-sistema-de-equações-diferenciais">Solução numérica para sistema de equações diferenciais</h2>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Por outro lado, quando uma equação ou sistema de equações diferenciais possui certa complexidade para a solução analítica, busca-se a solução numérica. Ainda que existam diversas bibliotecas para a solução de equações diferenciais pelo <code>R</code> (<code>deSolve</code>,<code>pracma</code>, <code>lsoda</code>), alguns sistemas simples podem ser resolvidos com os pacotes básicos de instalação:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;O procedimento mais simples emprega o <em>método de Euler</em>. A ideia básica do método consiste em integrar uma função diferencial de variação infinitesimal na variável independente (no caso, o tempo), para uma relação real, e a partir de valores iniciais fornecidos. Simplificando, o valor da função corresponderá ao acréscimo do incremento <em>dy</em> para cada intervalo <em>dx</em>, a partir da relação de cada reação envolvida na transformação dos compostos. Exemplificando para as reações presentes na <a href="#eq-dAdB" class="quarto-xref">Equação&nbsp;4</a>:</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solução de equações diferencias para conversão A--&gt;B</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># constante cinética de catálise</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">005</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># intervalo de tempo &amp; tempo máximo</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, tmax, dt) <span class="co"># vetor de tempo</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> tmax <span class="sc">/</span> dt <span class="sc">+</span> <span class="dv">1</span> <span class="co"># no. de pontos da simulação (necessário o acréscimo</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># de 1 para que vetores fiquem de mesmo tamanho)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> n), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> n) <span class="co"># construção da matriz de</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># uma linha pra cada composto, e uma coluna pra cada tempo dt</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># valores iniciais de concentração</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  dA <span class="ot">&lt;-</span> <span class="sc">-</span>k <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="co"># dA</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  dB <span class="ot">&lt;-</span> k <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="co"># dB</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dA <span class="co"># variação em A com acrécimo dA</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dB <span class="co"># variação em B com acréscimo dB</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># laço que acrescenta a cada intervalo dt o valor do novo teor para</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cada composto</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, x[<span class="dv">1</span>, ],</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"tempo, s"</span>, <span class="at">ylab =</span> <span class="st">"[espécie], M"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.025</span>),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">"l"</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>) <span class="co"># gráfico do composto 1</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">2</span>, ], <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>) <span class="co"># adição do gráfico do composto 2</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">2</span>, <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="dv">1</span>,  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="redes_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Solução de sistema de equações diferenciais por método de Euler para conversão de 1a. ordem da espécie A em B, a uma taxa cinética k.</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Experimente variar a constante cinética <em>k</em>, ou os valores iniciais para cada composto, e observe o efeito resultante. As reações metabólicas por diversas vezes apresentam interconversões entre compostos, tal que um substrato da reação também pode configurar-se como produto de catálise da mesma, e com taxas cinéticas de síntese (<em>k</em>) e degradação (<em>km</em>, ou <em>k minus</em>) para cada composto, como segue:</div>
<p><span id="eq-ABrever"><span class="math display">\[
A \begin{array}{c}
_{k}\\
\rightleftharpoons\\
^{km} \end{array} B
\tag{6}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nesse caso, o sistema de equações diferenciais ficará:</div>
<p><span id="eq-dABrev"><span class="math display">\[
dA=-k*A*dt+km*B*dt;\\
dB=k*A*dt-km*B*dt
\tag{7}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementando-se o trecho de código no <code>R</code>:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># constantes cinéticas de catálise</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">005</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># intervalo de tempo &amp; tempo máximo</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, tmax, dt) <span class="co"># define vetor de tempo</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> tmax <span class="sc">/</span> dt <span class="sc">+</span> <span class="dv">1</span> <span class="co"># define no. de pontos</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> n), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> n) <span class="co"># constroi matriz de uma</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># linha pra cada composto, e uma coluna pra cada tempo dt</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># valores iniciais de concetração</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  dA <span class="ot">&lt;-</span> <span class="sc">-</span>k <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">+</span> km <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  dB <span class="ot">&lt;-</span> k <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> km <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dA</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dB</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># laço que acrescenta a cada intervalo dt o valor de novo teor para</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cada composto</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, x[<span class="dv">1</span>, ],</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"tempo, s"</span>, <span class="at">ylab =</span> <span class="st">"[espécie], M"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">bty =</span> <span class="st">"l"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>) <span class="co"># gráfico do composto 1</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">2</span>, ], <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>) <span class="co"># adição do gráfico do composto 2</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">2</span>, <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">2</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="dv">1</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="redes_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Solução numérica para a conversão reversível da espécie A em B. k = km = 0,5; Ao e Bo = 1 (teores iniciais).</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Observe que os teores de A e B permanecem constantes ao longo do intervalo. Isso decorre dos valores idênticos das constantes cinéticas para cada reação direta e reversa, bem como dos teores iniciais para cada composto. Ilustrando uma variação desses:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exemplo de conversão A--&gt;B</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># constantes cinéticas de catálise</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">005</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># intervalo de tempo &amp; tempo máximo</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, tmax, dt) <span class="co"># define vetor de tempo</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> tmax <span class="sc">/</span> dt <span class="sc">+</span> <span class="dv">1</span> <span class="co"># define no. de pontos</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> n), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> n) <span class="co"># constroi matriz de </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># uma linha pra cada composto, e uma coluna pra cada tempo dt</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># valores iniciais de concentração</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  dA <span class="ot">&lt;-</span> <span class="sc">-</span>k <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">+</span> km <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  dB <span class="ot">&lt;-</span> k <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> km <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dA</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dB</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># laço que acrescenta a cada intervalo dt o valor de novo teor para</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cada composto</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, x[<span class="dv">1</span>, ],</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"tempo, s"</span>, <span class="at">ylab =</span> <span class="st">"[espécie], M"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">bty =</span> <span class="st">"l"</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>) <span class="co"># gráfico do composto 1</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">2</span>, ], <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>) <span class="co"># adição do gráfico do composto 2</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">2</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="redes_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Solução numérica para a conversão reversível da espécie A em B. k = 0,5; km = 0,1; Ao = 1; Bo = 0,2 (teores iniciais).</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Agora podemos imaginar uma reação um pouco mais complexa, como a ilustrada na <a href="#eq-kinMM" class="quarto-xref">Equação&nbsp;8</a>:</div>
<p><span id="eq-kinMM"><span class="math display">\[
A \begin{array}{c}
_{k1}\\
\rightleftharpoons\\
^{km1} \end{array} B
\begin{array}{c}
_{k2}\\
\rightarrow \\
  ^{}\end{array}C
\tag{8}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nesse caso, o sistema de equações diferenciais será:</div>
<p><span id="eq-dMMkin"><span class="math display">\[
dA=-k1*A*dt+km1*B*dt;\\
dB=k1*A*dt-km1*B*dt-k2*B*dt;\\
dC=k2*B
\tag{9}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Implementando-se o trecho de código:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solução de Euler para cinética de 3 compostos</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>km1 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># constantes cinéticas de catálise</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">005</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># intervalo de tempo &amp; tempo máximo</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, tmax, dt) <span class="co"># define vetor de tempo</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> tmax <span class="sc">/</span> dt <span class="sc">+</span> <span class="dv">1</span> <span class="co"># define no. de pontos</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span> <span class="sc">*</span> n), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> n) <span class="co"># constroi matriz de </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># uma linha pra cada composto, e uma coluna pra cada tempo dt</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># valores iniciais de concentração</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  dA <span class="ot">&lt;-</span> <span class="sc">-</span>k1 <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">+</span> km1 <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  dB <span class="ot">&lt;-</span> k1 <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> (km1 <span class="sc">+</span> k2) <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  dC <span class="ot">&lt;-</span> k2 <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dA</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dB</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">3</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">3</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dC <span class="co"># laço que acrescenta a cada intervalo dt</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># o valor de novo teor para cada composto</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, x[<span class="dv">1</span>, ],</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"tempo, s"</span>, <span class="at">ylab =</span> <span class="st">"[espécie], M"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.025</span>), <span class="at">bty =</span> <span class="st">"l"</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>) <span class="co"># gráfico do composto 1</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">2</span>, ], <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>) <span class="co"># adição do gráfico do composto 2</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">3</span>, ], <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">3</span>) <span class="co"># adição do gráfico do composto 3</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-MMdiffeq" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-MMdiffeq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="redes_files/figure-html/fig-MMdiffeq-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-MMdiffeq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1: Solução de Euler para uma cinética de 3 compostos. k1 = 0,5; k2 = 1; km1 = 0,1. Teores iniciais: Ao = 1; Bo = 0; Co = 0.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Observe que a <a href="#eq-dMMkin" class="quarto-xref">Equação&nbsp;9</a> acima reflete uma catálise de Michaelis-Mentem, embora considerando o teor da enzima <em>E</em> como constante e, portanto, independente da reação (ordem zero). E observe também que o gráfico da <a href="#fig-MMdiffeq" class="quarto-xref">Figura&nbsp;1</a> traduz, de certa forma, a condição Briggs-Haldane do estado estacionário tratada no <em>Enzimas</em>. Note que a variação de <em>B</em>, refletida nessa condição como o complexo <em>ES</em>, mantém-se relativamente constante por determinado intervalo de tempo, sendo produzida pela colisão com a enzima <em>E</em>, e desconstruida tanto por sua conversão a <em>E + P</em> (no caso, <em>C</em>), como por sua reversão a <em>E + S</em> (no caso, <em>A</em>).</div>
<div class="line-block">Para uma reação um pouco mais complexa:</div>
<p><span id="eq-ABCrev"><span class="math display">\[
A \begin{array}{c}
_{k1}\\
\rightleftharpoons\\
^{km1} \end{array} B
\begin{array}{c}
_{k2}\\
\rightleftharpoons\\
  ^{km2}\end{array}C
\tag{10}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;O que sugere o seguinte trecho de código no <code>R</code>:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solução de Euler para cinética reversível de 3 compostos</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># constantes da reação direta</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>km1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>km2 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">005</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, tmax, dt)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> tmax <span class="sc">/</span> dt <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span> <span class="sc">*</span> n), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> n)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  dA <span class="ot">&lt;-</span> <span class="sc">-</span>k1 <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">+</span> km1 <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  dB <span class="ot">&lt;-</span> k1 <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> (km1 <span class="sc">+</span> k2) <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    km2 <span class="sc">*</span> x[<span class="dv">3</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  dC <span class="ot">&lt;-</span> k2 <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> km2 <span class="sc">*</span> x[<span class="dv">3</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dA</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dB</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">3</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">3</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dC</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, x[<span class="dv">1</span>, ],</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"tempo, s"</span>, <span class="at">ylab =</span> <span class="st">"[espécie], mol/L"</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.025</span>), <span class="at">bty =</span> <span class="st">"l"</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">2</span>, ], <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">3</span>, ], <span class="at">col =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">8</span>, <span class="at">y =</span> <span class="fl">0.6</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="redes_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Solução de Euler para uma cinética reversível de 3 compostos. k1 = 1; km1 = 3; k2 = 5; km1 = 0,1. Teores iniciais: Ao = 1; Bo = 0; Co = 0.</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Agora, suponha uma cadeia mais complexa de reações bioquímicas, com moduladores alostéricos negativos (inibição, <em>ki</em>) e positivos (ativação, <em>ka</em>) para determinadas enzimas. O exemplo abaixo ilustra essa situação:</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/redeMetab1.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Um exemplo de reações bioquímicas em rota metabólica fictícia. As setas pontilhadas juntamente aos valores de ki e ka representam modulações alostéricas com respectivas constantes de inibição e ativação enzimáticas.</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assim, o conjunto de reações da rede metabólica acima pode ser equacionado como:</div>
<p><span id="eq-drede1"><span class="math display">\[
dA=-k1*A*dt+ka*F*dt;\\
dB=k1*A*dt+km3*D*dt-k3*B*dt-k2*B*dt-ki*E*dt;\\
dC=k2*B*dt;\\
\tag{11}\]</span></span></p>
<p><span id="eq-drede2"><span class="math display">\[
dD=k3*B*dt-km3*D*dt-k4*D*dt;\\
dE=k4*D*dt-k5*E*dt;\\
dF=k5*E*dt-ka*F*dt
\tag{12}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pode-se elaborar o trecho de código que segue para a solução numérica de Euler que envolve as equações diferenciais elencadas acima como:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solução para rota metabólica com inibição e ativação alostéricas</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Constantes cinéticas e alostéricas</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>k3 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>km3 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>k5 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>ki <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="co"># constante de inibição</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>ka <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># constante de ativação</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">005</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, tmax, dt)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> tmax <span class="sc">/</span> dt <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">6</span> <span class="sc">*</span> n), <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">ncol =</span> n)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores iniciais dos compostos</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">3</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">4</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">5</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">6</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sistema de equações inserido na matriz dos intervalos</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  dA <span class="ot">&lt;-</span> <span class="sc">-</span>k1 <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">+</span> ka <span class="sc">*</span> x[<span class="dv">6</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  dB <span class="ot">&lt;-</span> k1 <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">+</span> km3 <span class="sc">*</span> x[<span class="dv">4</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> k3 <span class="sc">*</span> </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> k2 <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> ki <span class="sc">*</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  dC <span class="ot">&lt;-</span> k2 <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  dD <span class="ot">&lt;-</span> k3 <span class="sc">*</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> km3 <span class="sc">*</span> x[<span class="dv">4</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> k4 <span class="sc">*</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">4</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  dE <span class="ot">&lt;-</span> k4 <span class="sc">*</span> x[<span class="dv">4</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> k5 <span class="sc">*</span> x[<span class="dv">5</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  dF <span class="ot">&lt;-</span> k5 <span class="sc">*</span> x[<span class="dv">5</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt <span class="sc">-</span> ka <span class="sc">*</span> x[<span class="dv">6</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">*</span> dt</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adição dy aos valores de y</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">1</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dA</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">2</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dB</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">3</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">3</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dC</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">4</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">4</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dD</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">5</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">5</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dE</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">6</span>, i] <span class="ot">&lt;-</span> x[<span class="dv">6</span>, i <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">+</span> dF</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Elaboração dos gráficos cinéticos</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, x[<span class="dv">1</span>, ],</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"tempo,s"</span>, <span class="at">ylab =</span> <span class="st">"[espécie], mol/L"</span>, </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.025</span>), <span class="at">bty =</span> <span class="st">"l"</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">2</span>, ], <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">3</span>, ], <span class="at">col =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">4</span>, ], <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">4</span>)</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">5</span>, ], <span class="at">col =</span> <span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">5</span>)</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, x[<span class="dv">6</span>, ], <span class="at">col =</span> <span class="dv">6</span>, <span class="at">lty =</span> <span class="dv">6</span>)</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y =</span> <span class="fl">0.65</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>), </span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="redes_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Solução para uma via metabólica fictícia apresentando inibição (ki) e ativação (ka) alostéricas. Taxas cinéticas: k1 = 2, k2 = 0,5, k3 = 0,7, km3 = 0,3, k4 = 5, k5 = 1, ki = 0,3, ka = 0.2. Valores iniciais dos compostos: A=1; B, C, D, E, F = 0</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Altere as constantes cinéticas e/ou alostéricas do sistema acima e observe o efeito em cada um dos compostos. De modo geral, a solução de Euler aplicada a sistemas de complexidade crescente, como uma rede metabólica, pode apresentar desvios centrados na seleção do valor de <em>dt</em>, ou mesmo produzir valores inconsistentes. Para contornar essa situação utiliza-se outros algoritmos, tais como de <em>Runge-Kutta de 2a., 3a, ou 4a. ordem</em>, presentes nos pacotes do <code>R</code>, ou ainda por <em>análise de sistemas</em>.</div>
</section>
<section id="algumas-reações-do-metabolismo-da-glicose" class="level2">
<h2 class="anchored" data-anchor-id="algumas-reações-do-metabolismo-da-glicose">Algumas reações do metabolismo da glicose</h2>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Para uma aplicação do método de <em>Runge-Kutta de 4a. ordem</em> é necessário instalar o pacote <code>deSolve</code> ou similar para a solução de sistema de equações diferenciais ordinárias de 1a. ordem ou diferenciais parciais. A biblioteca agrega funções que permitem um código mais enxuto e simples para a solução do sistema. Ilustrando sua aplicação, seguem algumas das muitas relações simples da rede metabólica que envolve a <em>glicólise, gliconeogênese, e via das pentoses</em> nas células:</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/redeMetab2.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Algumas relações metabólicas envolvidas na glicólise, gliconeogênese e vias das pentoses.</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pode-se atribuir a essas relações as seguintes reações do metabolismo:</div>
<p><span id="eq-redeMetab1"><span class="math display">\[
G6P
\begin{array}{c}
_{k1}\\
\rightarrow \\
  ^{}\end{array} R5P\\
G3P+DHCP
\begin{array}{c}
_{k2}\\
\rightarrow \\
  ^{}\end{array} PEP\\
2G3P
\begin{array}{c}
_{k3}\\
\rightarrow \\
  ^{}\end{array} 6GP\\
R5P
\begin{array}{c}
_{k4}\\
\rightarrow \\
  ^{}\end{array} G3P\\
2PEP
\begin{array}{c}
_{k5}\\
\rightarrow \\
  ^{}\end{array} G6P
\tag{13}\]</span></span></p>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;O trecho de código para a solução por Runge-Kutta pode ser o exemplificado a seguir, com resultados em dois gráficos; inicialmente com as curvas isoladas, e depois reunidas.</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Solução para cinética de conversão em algumas vias metabólicas</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Parâmetros das reações</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>k3 <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>k5 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(k1, k2, k3, k4, k5)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Valores iniciais para cada composto</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>G6P0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>R5P0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>G3P0 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>DHCP0 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>PEP0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalo de tempo</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>tmin <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>tempo <span class="ot">&lt;-</span> <span class="fu">seq</span>(tmin, tmax, dt)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para as derivadas das espécies no tempo</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>eq.dif <span class="ot">&lt;-</span> <span class="cf">function</span>(tempo, x, parms) {</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># especificação dos compostos</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  G6P <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  R5P <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  G3P <span class="ot">&lt;-</span> x[<span class="dv">3</span>]</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  DHCP <span class="ot">&lt;-</span> x[<span class="dv">4</span>]</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  PEP <span class="ot">&lt;-</span> x[<span class="dv">5</span>]</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># equações diferenciais</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  dG6P <span class="ot">&lt;-</span> <span class="sc">-</span>k1 <span class="sc">*</span> G6P <span class="sc">+</span> k3 <span class="sc">*</span> G3P<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> k5 <span class="sc">*</span> PEP<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  dR5P <span class="ot">&lt;-</span> k1 <span class="sc">*</span> G6P <span class="sc">-</span> k4 <span class="sc">*</span> R5P</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  dG3P <span class="ot">&lt;-</span> <span class="sc">-</span>k2 <span class="sc">*</span> G3P <span class="sc">*</span> DHCP <span class="sc">-</span> k3 <span class="sc">*</span> G3P<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> k4 <span class="sc">*</span> R5P</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  dDHCP <span class="ot">&lt;-</span> <span class="sc">-</span>k2 <span class="sc">*</span> G3P <span class="sc">*</span> DHCP</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  dPEP <span class="ot">&lt;-</span> k2 <span class="sc">*</span> G3P <span class="sc">*</span> DHCP <span class="sc">-</span> k5 <span class="sc">*</span> PEP<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">c</span>(dG6P, dR5P, dG3P, dDHCP, dPEP)) <span class="co"># incrementos das espécies</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotina de lsoda pra solução diferencial ordinária</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">lsoda</span>(<span class="fu">c</span>(G6P0, R5P0, G3P0, DHCP0, PEP0), tempo, eq.dif, parms,</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">rtol =</span> <span class="fl">1e-4</span>, <span class="at">atol =</span> <span class="fl">1e-6</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Saída do resultado em vetores pra cada quantidade (tempo e espécies)</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> out[, <span class="dv">1</span>]</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>G6P <span class="ot">&lt;-</span> out[, <span class="dv">2</span>]</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>R5P <span class="ot">&lt;-</span> out[, <span class="dv">3</span>]</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>G3P <span class="ot">&lt;-</span> out[, <span class="dv">4</span>]</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>DHCP <span class="ot">&lt;-</span> out[, <span class="dv">5</span>]</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>PEP <span class="ot">&lt;-</span> out[, <span class="dv">6</span>]</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Elaboração de gráficos verticais</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>))</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, G6P, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, R5P, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, G3P, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, DHCP, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, PEP, <span class="at">type =</span> <span class="st">"l"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="redes_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Cinética de conversões para uma rede metabólica simples envolvendo algumas reações da glicólise, gliconeogênese e via das pentoses. Valores das constantes cinéticas: k1 = 0,1; k2 = 0,5; k3 = 0,05; k4 = 0,5; k5 = 0,2. Valores iniciais dos compostos: G6P = 1; para os demais, 0.</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elaboração de gráfico com todas as espécies</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, G6P, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">ylab =</span> <span class="st">"[espécie]"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, R5P, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, G3P, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, DHCP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">4</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, PEP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">5</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"G6P"</span>, <span class="st">"R5P"</span>, <span class="st">"G3P"</span>, <span class="st">"DHCP"</span>, <span class="st">"PEP"</span>), </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="redes_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Cinética de conversões para uma rede metabólica simples envolvendo algumas reações da glicólise, gliconeogênese e via das pentoses. Valores das constantes cinéticas: k1 = 0,1; k2 = 0,5; k3 = 0,05; k4 = 0,5; k5 = 0,2. Valores iniciais dos compostos: G6P = 1; para os demais, 0.</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Perceba que, pelas quantidades oferecidas à simulação, ou seja, constantes cinéticas e valores iniciais, G3P e PEP registram um intervalo significativo em elevação, também coincidente por sua presença em várias das relações da <a href="#eq-redeMetab1" class="quarto-xref">Equação&nbsp;13</a>.</div>
</section>
<section id="cinética-do-metabolismo-de-6-mercaptopurina" class="level2">
<h2 class="anchored" data-anchor-id="cinética-do-metabolismo-de-6-mercaptopurina">Cinética do metabolismo de 6-mercaptopurina</h2>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Elevando um pouco a complexidade de redes metabólicas, pode-se exemplificar o metabolismo celular da 6-mercaptopurina (6-MP) em função do teor de ATP celular <span class="citation" data-cites="lavrova2017ordinary">(<a href="#ref-lavrova2017ordinary" role="doc-biblioref">Lavrova et al. 2017</a>)</span>. Como antagonista da purina, o fármaco é empregado na quimioterapia para o tratamento de leucemia linfocítica, interrompendo o crescimento celular, embora produzindo efeitos colaterais citotóxicos advindos de reações com o grupo tiol.</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A <a href="#fig-fig6MP" class="quarto-xref">Figura&nbsp;2</a> representa um esquema simplificado do metabolismo de 6-MP. As concentrações das espécies e constantes cinéticas originam-se dos valores de concentração em <span class="math inline">\(\mu\)</span>mol/mL, e tempo em dias.</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fig6MP" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig6MP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/6mercaptopurina.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig6MP-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2: Metabolismo esquemático simplificado para o metabolismo de 6-mercaptopurina (adaptado de Lavrova et al., 2017).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Para as 10 reações referentes às ODEs que compõem a representação do metabolismo de 6-MP <span class="citation" data-cites="lavrova2017ordinary">(<a href="#ref-lavrova2017ordinary" role="doc-biblioref">Lavrova et al. 2017</a>)</span>, o trecho de código abaixo implementa a solução por Runge-Kutta de 4a. ordem pela função <code>lsoda</code>:</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Degradação de 6-mercaptopurina e solução de Runge-Kutta</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parâmetros</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>k0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>k3 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fl">1e-5</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>k7 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>k8 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>km7 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>km1 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>km2 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>km3 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>km4 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>km8 <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>VPUR <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>VD <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>VOUT <span class="ot">&lt;-</span> <span class="fl">1e-4</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista de parâmetros</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(k0, k1, k2, k3, k4, k7, k8, km7, km1, km2, km3, km4, km8, </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>           VPUR, VD, VOUT)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># especificação dos compostos</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>MPex <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>MPin <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>TIMP <span class="ot">&lt;-</span> x[<span class="dv">3</span>]</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>TXMP <span class="ot">&lt;-</span> x[<span class="dv">4</span>]</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>TGMP <span class="ot">&lt;-</span> x[<span class="dv">5</span>]</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>meTGMP <span class="ot">&lt;-</span> x[<span class="dv">6</span>]</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>TITP <span class="ot">&lt;-</span> x[<span class="dv">7</span>]</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>ATP <span class="ot">&lt;-</span> x[<span class="dv">8</span>]</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>AMP <span class="ot">&lt;-</span> x[<span class="dv">9</span>]</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>PP <span class="ot">&lt;-</span> x[<span class="dv">10</span>]</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Concentrações iniciais das espécies</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>reag0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">MPex0 =</span> <span class="fl">0.68</span>, <span class="at">MPin0 =</span> <span class="dv">0</span>, <span class="at">TIMP0 =</span> <span class="dv">0</span>, <span class="at">TXMP0 =</span> <span class="dv">0</span>, <span class="at">TGMP0 =</span> <span class="dv">0</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">meTGMP0 =</span> <span class="dv">0</span>, <span class="at">TITP0 =</span> <span class="dv">0</span>, <span class="at">ATP0 =</span> <span class="fl">0.2</span>, <span class="at">AMP0 =</span> <span class="dv">0</span>, <span class="at">PP0 =</span> <span class="dv">0</span>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Definição do intervalo de tempo</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>tmin <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>tmax <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>tempo <span class="ot">&lt;-</span> <span class="fu">seq</span>(tmin, tmax, dt)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para as derivadas de cada espécie</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>eq.dif <span class="ot">&lt;-</span> <span class="cf">function</span>(tempo, x, parms) {</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Definição de parâmetros</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  MPex <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>  MPin <span class="ot">&lt;-</span> x[<span class="dv">2</span>]</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  TIMP <span class="ot">&lt;-</span> x[<span class="dv">3</span>]</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  TXMP <span class="ot">&lt;-</span> x[<span class="dv">4</span>]</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  TGMP <span class="ot">&lt;-</span> x[<span class="dv">5</span>]</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  meTGMP <span class="ot">&lt;-</span> x[<span class="dv">6</span>]</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  TITP <span class="ot">&lt;-</span> x[<span class="dv">7</span>]</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  ATP <span class="ot">&lt;-</span> x[<span class="dv">8</span>]</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>  AMP <span class="ot">&lt;-</span> x[<span class="dv">9</span>]</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>  PP <span class="ot">&lt;-</span> x[<span class="dv">10</span>]</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Equações diferenciais</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  dMPex <span class="ot">&lt;-</span> <span class="sc">-</span>k0 <span class="sc">*</span> MPex</span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>  dMPin <span class="ot">&lt;-</span> <span class="sc">-</span>(VPUR <span class="sc">+</span> k1) <span class="sc">*</span> MPin <span class="sc">+</span> k0 <span class="sc">*</span> MPex <span class="sc">+</span> km1 <span class="sc">*</span> TIMP</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>  dTIMP <span class="ot">&lt;-</span> k1 <span class="sc">*</span> MPin <span class="sc">+</span> km8 <span class="sc">*</span> TITP <span class="sc">-</span> (k2 <span class="sc">+</span> k7 <span class="sc">*</span> ATP <span class="sc">+</span> km1 <span class="sc">+</span> k8 <span class="sc">*</span> PP) <span class="sc">*</span> </span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>    TIMP <span class="sc">+</span> km2 <span class="sc">*</span> TXMP <span class="sc">+</span> km7 <span class="sc">*</span> TITP <span class="sc">*</span> AMP</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>  dTXMP <span class="ot">&lt;-</span> k2 <span class="sc">*</span> TIMP <span class="sc">-</span> k3 <span class="sc">*</span> TXMP <span class="sc">*</span> ATP <span class="sc">-</span> km2 <span class="sc">*</span> TXMP <span class="sc">+</span> km3 <span class="sc">*</span> TGMP <span class="sc">*</span> </span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>    AMP <span class="sc">*</span> PP</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>  dTGMP <span class="ot">&lt;-</span> k3 <span class="sc">*</span> TXMP <span class="sc">*</span> ATP <span class="sc">-</span> (k4 <span class="sc">+</span> VD) <span class="sc">*</span> TGMP <span class="sc">-</span> km3 <span class="sc">*</span> TGMP <span class="sc">*</span> AMP <span class="sc">*</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>    PP <span class="sc">+</span> km4 <span class="sc">*</span> meTGMP</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a>  dmeTGMP <span class="ot">&lt;-</span> k4 <span class="sc">*</span> TGMP <span class="sc">-</span> VOUT <span class="sc">*</span> meTGMP <span class="sc">-</span> km4 <span class="sc">*</span> meTGMP</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>  dTITP <span class="ot">&lt;-</span> k8 <span class="sc">*</span> TIMP <span class="sc">*</span> PP <span class="sc">-</span> km8 <span class="sc">*</span> TITP <span class="sc">+</span> k7 <span class="sc">*</span> TIMP <span class="sc">*</span> ATP <span class="sc">-</span> km7 <span class="sc">*</span> </span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a>    TITP <span class="sc">*</span> AMP</span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>  dATP <span class="ot">&lt;-</span> <span class="sc">-</span>k7 <span class="sc">*</span> TIMP <span class="sc">*</span> ATP <span class="sc">+</span> km3 <span class="sc">*</span> TGMP <span class="sc">*</span> AMP <span class="sc">*</span> PP <span class="sc">-</span> k3 <span class="sc">*</span> TXMP <span class="sc">*</span> </span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a>    ATP <span class="sc">+</span> km7 <span class="sc">*</span> TITP <span class="sc">*</span> AMP</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>  dAMP <span class="ot">&lt;-</span> <span class="sc">-</span>km3 <span class="sc">*</span> TGMP <span class="sc">*</span> AMP <span class="sc">*</span> PP <span class="sc">+</span> k3 <span class="sc">*</span> TXMP <span class="sc">*</span> ATP <span class="sc">+</span> k7 <span class="sc">*</span> TIMP <span class="sc">*</span> </span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>    ATP <span class="sc">-</span> km7 <span class="sc">*</span> TITP <span class="sc">*</span> AMP</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>  dPP <span class="ot">&lt;-</span> <span class="sc">-</span>k8 <span class="sc">*</span> TIMP <span class="sc">*</span> PP <span class="sc">+</span> km8 <span class="sc">*</span> TITP <span class="sc">-</span> km3 <span class="sc">*</span> TGMP <span class="sc">*</span> AMP <span class="sc">*</span> PP <span class="sc">+</span> k3 <span class="sc">*</span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>    TXMP <span class="sc">*</span> ATP</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">c</span>(dMPex, dMPin, dTIMP, dTXMP, dTGMP, dmeTGMP, dTITP, dATP, </span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>         dAMP, dPP)) <span class="co"># lista de valores diferenciais para cada espécie</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotina de lsoda pra solução equações diferenc. ordinárias</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>sol.eq <span class="ot">&lt;-</span> <span class="fu">lsoda</span>(reag0, tempo, eq.dif, parms,</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">rtol =</span> <span class="fl">1e-4</span>, <span class="at">atol =</span> <span class="fl">1e-6</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolamento das colunas de resultdos</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> sol.eq[, <span class="dv">1</span>]</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>MPex <span class="ot">&lt;-</span> sol.eq[, <span class="dv">2</span>]</span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>MPin <span class="ot">&lt;-</span> sol.eq[, <span class="dv">3</span>]</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>TIMP <span class="ot">&lt;-</span> sol.eq[, <span class="dv">4</span>]</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>TXMP <span class="ot">&lt;-</span> sol.eq[, <span class="dv">5</span>]</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>TGMP <span class="ot">&lt;-</span> sol.eq[, <span class="dv">6</span>]</span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>meTGMP <span class="ot">&lt;-</span> sol.eq[, <span class="dv">7</span>]</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>TITP <span class="ot">&lt;-</span> sol.eq[, <span class="dv">8</span>]</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>ATP <span class="ot">&lt;-</span> sol.eq[, <span class="dv">9</span>]</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>AMP <span class="ot">&lt;-</span> sol.eq[, <span class="dv">10</span>]</span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>PP <span class="ot">&lt;-</span> sol.eq[, <span class="dv">11</span>]</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Elaboração do gráfico</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t, MPex, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"tempo, dias"</span>, </span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"[espécie], umol/L"</span>)</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, MPin, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, TIMP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, TXMP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">4</span>)</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, TGMP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">5</span>)</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, meTGMP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">6</span>, <span class="at">lty =</span> <span class="dv">6</span>)</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, TITP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">7</span>, <span class="at">lty =</span> <span class="dv">7</span>)</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, ATP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">8</span>, <span class="at">lty =</span> <span class="dv">8</span>)</span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, AMP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">9</span>, <span class="at">lty =</span> <span class="dv">9</span>)</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(t, PP, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="dv">10</span>, <span class="at">lty =</span> <span class="dv">10</span>)</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.65</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"MPex"</span>, <span class="st">"MPin"</span>, <span class="st">"TIMP"</span>, <span class="st">"TXMP"</span>,</span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"TGMP"</span>, <span class="st">"meTGMP"</span>, <span class="st">"TITP"</span>, <span class="st">"ATP"</span>,</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"AMP"</span>, <span class="st">"PP"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>,</span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>                                                           <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>,</span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>                                                           <span class="dv">9</span>, <span class="dv">10</span>), </span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.7</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="redes_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Dependência da dinâmica da rede metabólica de degradação de 6-mercaptopurina em função do teor inicial de ATP a 0,2 umol/L. Os valores iniciais e parâmetros são descritos no trecho de código.</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Como a dinâmica de variação dos compostos é dependente do teor inicial de ATP celular, experimente variar esse valor inicial (ex: ATP0=2):</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/rede6MP.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Dependência da dinâmica da rede metabólica de degradação de 6-mercaptopurina em função do teor inicial de ATP a 2 umol/L. Os valores iniciais e parâmetros são descritos no trecho de código.</figcaption>
</figure>
</div>
</div>
</div>
<div class="line-block">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Observe que, com a redução de 10x no teor de ATP, TGMP e TIMP mantiveram teores mais estáveis ao longo do período.</div>



</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> De volta ao topo</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Referências</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-lavrova2017ordinary" class="csl-entry" role="listitem">
Lavrova, Anastasia I, Eugene B Postnikov, Andrey Yu Zyubin, e Svetlana V Babak. 2017. <span>«Ordinary differential equations and Boolean networks in application to modelling of 6-mercaptopurine metabolism»</span>. <em>Royal Society Open Science</em> 4 (4): 160872.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>