{"title":"Interactive Simulations for Biophysical Chemistry with JSPlotly & GSPlotly","markdown":{"yaml":{"title":"Interactive Simulations for Biophysical Chemistry with JSPlotly & GSPlotly","format":"html","toc":true,"toc-depth":2,"number-sections":true,"lang":"en"},"headingText":"Instructions","headingAttr":{"id":"","classes":["unnumbered"],"keyvalue":[]},"containsRefs":false,"markdown":"\n\n| To illustrate the potential use of *JSPlotly* for biochemistry and related fields, here are some examples of simulations and data analysis whose graphs are often found in textbooks and related content. To get the most out of each topic, try following the suggestions for *parametric manipulation* in each topic.\n\\\n\n\n\n```{r, eval=FALSE}\n\n1. Choose a topic;\n2. Click on the corresponding graph;\n3. Click on \"Add Plot\";\n4. Use the mouse for interactivity and/or edit the code.\n\nReminder: the editor uses infinite undo/redo in the code (Ctrl+Z / Shift+Ctrl+Z)!\n```\n\n\n## Acid-base equilibrium and buffer systems\n\n#### Context: {.unnumbered}\n\n| The example illustrates the addition of a base to a system containing a weak acid and its conjugate base. The titration equation refers to a *triprotic acid*, the phosphoric acid of the buffer of the same name, but it would also work for many others, such as those present in the Krebs cycle (citrate, isocitrate). \n\n\n#### Equation: {.unnumbered}\n\n$$\nfa= \\frac{1}{1 + 10^{pKa1 - pH}} + \\frac{1}{1 + 10^{pKa2 - pH}} + \\frac{1}{1 + 10^{pKa3 - pH}}\n$$\n*Where\nfa = acid fraction (protonatable groups)\n\\\n\n[![](Eq/tit_acbase.png)](Eq/jsp_acbase.html){target=\"_blank\"}\n\\\n<!---div class=\"jsplotly_sup-fundo\"> --->\n\n### Suggestion: {.unnumbered}\n\n```{r, eval =FALSE}\n\"A. Converting the phosphate buffer (triprotic) curve to bicarbonate buffer (diprotic)\"\n\n1. Change the pKa values for the bicarbonate buffer: pKa1 = 6.1, and pKa2 = 10.3;\n2. Set a very large value for pKa3 (e.g., 1e20). \n3. Click \"add plot.\"\n\nExplanation: pKa is a term that represents the logarithm of a dissociation constant (-log[Ka]). With an extreme value, the denominator becomes equally large, canceling out the term that carries pKa3. In JavaScript and other languages, ‘e’ represents the notation for power of 10.\n\n\"B. Converting the bicarbonate buffer curve to acetate\"\n\n1. Simply repeat the above procedure with pKa1 = 4.75 and eliminate pKa2.\n\n```\n\\\n\n## Net charge network in peptides\n\n#### Context: {.unnumbered}\n\n| The code refers to the net charge network present in any sequence of amino acid residues. Here we illustrate *angiotensin II*, an important peptide for blood pressure regulation and electrolyte balance, whose converting enzyme is associated with the mechanism of cell invasibility by SARS-CoV-2.\n\n\n#### Equation: {.unnumbered}\n\n| There is no direct equation for this simulation, as the algorithm needs to decide the charge based on the basic or acidic nature of the residue at a given pH value (see the *script*). Thus:\n\n$$\nq =\n\\begin{cases}\n-\\dfrac{1}{1 + 10^{pK_a - pH}} & \\text{(acid group)} \\\\\\\\\n\\dfrac{1}{1 + 10^{pH - pK_a}} & \\text{(basic group)}\n\\end{cases}\n$$\n\\\n\n*Where\n\n- pKa = value of the antilogarithm of base 10 for the acid dissociation equilibrium constant, Ka (or log[Ka]).\n\n\n[![](Eq/cargaAA.png)](Eq/jsp_cargaAA.html){target=\"_blank\"}\n\\\n<!---div class=\"jsplotly_sup-fundo\"> --->\n\n### Suggestion: {.unnumbered}\n\n```{r, eval =FALSE}\n1. Select the peptide sequence below and observe the charge distribution:\n\n\"Ala,Lys,Arg,Leu,Phe,Glu,Cys,Asp,His\"\n\n2. Simulate the pH condition of the stomach (\"const pH = 1.5\") and check the change in charges in the peptide. \n\n3. Select a physiological peptide (e.g., oxytocin), observe its charge in blood (pH 7.5), and reflect on its potential for electrostatic interaction with cellular components.\n\n\"Cys,Tyr,Ile,Gln,Asn,Cys,Pro,Leu,Gly\" - oxytocin\n```\n\\\n\n\n## Interaction of oxygen with myoglobin and hemoglobin\n\n#### Context: {.unnumbered}\n\n| The oxygen molecule can combine with the *heme* group of myoglobin and hemoglobin in different ways, depending on the cooperativity exhibited in the latter due to its quaternary structure. The following model illustrates this interaction using the *Hill equation*. \n\n\n#### Equation: {.unnumbered}\n\n\n$$\nY= \\frac{pO_2^{nH}}{p_{50}^{nH} + pO_2^{nH}}\n$$\n\\\n\n*Where*\n\nY = degree of oxygen saturation in the protein;\n\n\n- pO$_{2}$ = oxygen pressure;\n- p$_{50}$ = oxygen pressure at 50% saturation;\n- nH = Hill coefficient for the interaction;\n\\\n\n\n[![](Eq/O2.png)](Eq/jsp_O2.html){target=\"_blank\"}\n\\\n<!---div class=\"jsplotly_sup-fundo\"> --->\n\n### Suggestion: {.unnumbered}\n\n```{r, eval =FALSE}\n1. Run the application (\"add plot\"). Note that the value of \"nH\" for the Hill constant is \"1,\" meaning there is no cooperativity effect.\n\n2. Now replace the value of \"nH\" with the Hill coefficient for hemoglobin, 2.8, and run again!\n```\n\\\n\n\n## Bohr effect on hemoglobin (pH)\n\n\n#### Context: {.unnumbered}\n\n| Some physiological or pathological conditions can alter the binding affinity of oxygen to hemoglobin, such as temperature, certain metabolites (2,3-BPG), and the hydrogen ion content of the solution.\n\n#### Equation: {.unnumbered}\n\n$$\nY(pO_2) = \\frac{{pO_2^n}}{{P_{50}^n + pO_2^n}}, \\quad \\text{with } P_{50} = P_{50,\\text{ref}} + \\alpha (pH_{\\text{ref}} - pH)\n$$\n\\\n*Where*,\n\n- Y = hemoglobin saturation,\n- pO$_{2}$ = partial pressure of oxygen (in mmHg),\n- P$_{50}$ = pressure of O$_{2}$ at which hemoglobin is 50% saturated,\n- P$_{50,ref}$ = 26 mmHg (standard value),\n- $\\alpha$ = 50 (Bohr effect intensity),\n- pH$_{ref}$ = 7.4,\n- n = 2.8 = Hill coefficient for hemoglobin.\n\n\n\n[![](Eq/jspl_bohr.png)](Eq/jspl_bohr.html)\n\n\n\n## Isoelectric Point in Proteins\n\n\n#### Context: {.unnumbered}\n\n| The *script* for this simulation is based on the distribution of the charge network for a polyelectrolyte, and the identification of the pH value at which this network is zero, i.e., the *isoelectric point (or isoionic point), pI*. The example uses the primary sequence of lysozyme, a hydrolase that acts to break down the microbial wall.\n\n#### Equation: {.unnumbered}\n\n\n$$\nq_{\\text{net}}(pH) = \\sum_{i=1}^{N} \\left[ n_i \\cdot q_{B_i} + \\frac{n_i}{1 + 10^{pH - pK_{a_i}}} \\right]\n$$\n\\\n*Where*,\n\n- qnet = total net charge;\n- qB$_{i} = charge of the basic form for residue i (e.g., +1 for Lys, 0 for Asp);\n- n$_{i}$ = number of groups of residue *i*.\n\n[![](Eq/pI.png)](Eq/jsp_pI.html)\n\n\n#### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n\"Finding the pI for other proteins\"\n\n1. You can check the titration of any other protein or peptide sequence by simply replacing the primary sequence contained in the code. An assertive way to perform this replacement involves:\na. Search for the \"FASTA\" sequence of the protein in NCBI (\"https://www.ncbi.nlm.nih.gov/protein/\") - e.g., \"papain\";\nb. Click on \"FASTA\" and copy the sequence 1a. obtained;\nc. Paste the sequence into a website for residue quantification (e.g., \"https://www.protpi.ch/Calculator/ProteinTool\");\n4. Replace the sequence in the code. \n```\n\\\n\n\n## Catalysis and enzyme inhibition\n\n### Context: {.unnumbered}\n\n| The simulation aims to provide a general equation for enzyme inhibition studies, covering *competitive, non-competitive, and competitive (pure or mixed) models*, also allowing the study of enzyme catalysis in the absence of an inhibitor.\n#### Equation: {.unnumbered}\n\n\n$$\nv=\\frac{Vm*S}{Km(1+\\frac{I}{Kic})+S(1+\\frac{I}{Kiu})}\n$$\n\\\n*Where*\n\n- S = substrate content for reaction;\n- Vm = reaction limit speed (in books, maximum speed);\n- Km = Michaelis-Mentem constant;\n- Kic = inhibitor dissociation equilibrium constant for competitive model;\n- Kiu = inhibitor dissociation equilibrium constant for non-competitive model\n\\\n\n\n[![](Eq/kin_inib.png)](Eq/jsp_kin_inib.html){target=\"_blank\"}\n\\\n<!---div class=\"jsplotly_sup-fundo\"> --->\n\n### Suggestion: {.unnumbered}\n\n```{r, eval =FALSE}\n\"A. Enzymatic catalysis in the absence of inhibitor.\"\n1. Just run the application with the general equation. Note that the values for Kic and Kiu are high (1e20). Thus, with high \"dissociation constants,\" the interaction of the inhibitor with the enzyme is irrelevant, returning the model to the classic Michaelis-Mentem equation.\n2. Try changing the values of Vm and Km, comparing graphs.\n3. Use the geographic coordinates feature on the icon bar (\"Toggle Spike Lines\") to consolidate the mathematical meaning of Km, as well as to observe the effect of different values on the graph.\n\n\"B. Competitive inhibition model.\"\n1. To observe or compare the Michaelis model with the competitive inhibition model, simply replace the value of Kic with a consistent number (e.g., Kic= 3).\n\n\"C. Incompetitive inhibition model.\"\n1. The same suggestion above applies to the incompetitive model, this time replacing the value for Kiu.\n\n\"D. Pure non-competitive inhibition model.\"\n1. In this model, the simulation is performed using equal values for Kic and Kiu.\n\n\"E. Mixed non-competitive inhibition model.\"\n1. For this model, simply assign different values to Kic and Kiu.\n```\n\\\n\n## Thermodynamic stability of nucleic acids\n\n### Context: {.unnumbered}\n\n| Several factors contribute to the thermodynamic stability of biopolymers, either stabilizing or destabilizing them. This simulation deals with a thermal denaturation curve for DNA in the presence or absence of some of these compounds: trehalose (stabilizing osmolyte) and guanidine chloride (destabilizing).\n\n\n### Equation: {.unnumbered}\n\n$$\ny(T) = \\frac{1}{1 + e^{-\\frac{T - T_m}{\\beta}}}\n$$\n\n\n*Where*,\n\n- y(T): fraction of denatured DNA at a given temperature T;\n- Tm: transition temperature (*melting*, temperature at which 50% of molecules are double-stranded and 50% are single-stranded);\n- $\\beta$: parameter that adjusts the slope of the curve (affected by trehalose and guanidine).\n\n\n*Note:*\n\n1. Trehalose as a stabilizer (reduces $\\beta$);\n2. Guanidine as a denaturant (increases $\\beta$);\n\n\n[![](Eq/denat_DNA.png)](Eq/jsp_denat_DNA_no_osmol.html){target=\"_blank\"}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Try testing various conditions involved in the simulation, such as:\na) variation of Tm;\nb) variation of the $\\beta$ parameter;\nc) variation of trehalose content;\nd) variation of guanidine chloride content.\n```\n\n\n## Van der Waals equation for ideal gases\n\n\n### Context: {.unnumbered}\n\n| An adaptation that relates the thermodynamic quantities of pressure, volume, and temperature for ideal gases is the *van der Waals equation*. In this equation, coefficients are calculated that estimate the existence of a volume and interparticle interactions. Thus, the van der Waals equation corrects the ideal gas equation by considering a term to compensate for intermolecular forces (a/V$^{2}$) and the available volume, which discounts the volume occupied by the gas molecules themselves.\n\n\n| The simulation offers additional interactivity through the presence of sliders for temperature and for the finite volume coefficient (*b*) and particle interaction coefficient (*a*).\n\n### Equation: {.unnumbered}\n\n\n$$\nP = \\frac{RT}{V - b} - \\frac{a}{V^2}\n$$\n\n- P = gas pressure (atm);\n- V = molar volume (L);\n- T = temperature (K);\n- R = 0.0821 = ideal gas constant (L·atm/mol·K);\n- a = intermolecular attraction constant (L$^{2}$·atm/mol$^{2})\n- b = excluded volume constant (L/mol)\n\n\n\n[![](Eq/vanderWaals.png)](Eq/jsp_vanderWaals.html){target=\"_blank\"}\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n\n1. Try varying the parameters of the equation using the slider for temperature, as well as for coefficients \"a and b.\"\n2. Discuss which of the coefficients has the greatest effect on the curve profile and the reason for this.\n\n```\n\\\n\n## Equilibrium of ATP production from reactants, temperature, and pH\n\n### Context: {.unnumbered}\n\n| Intracellular ATP production involves the classic chemical equilibrium relationship between reactants and products as a function of reaction temperature, adjusted to a specific pH value. By varying one or both reactant concentrations or physical-chemical parameters, it is possible to quantify the product using the following thermodynamic reaction:\n\n\n### Equation: {.unnumbered}\n\n$$\n\\Delta G = \\Delta G^{\\circ'} + RT \\ln\\left(\\frac{[\\text{ADP}] \\cdot [\\text{P}_i]}{[\\text{ATP}]}\\right) + 2{,}303 \\cdot RT \\cdot n_H \\cdot \\text{pH}\n$$\n\n*Where*,\n\n- $\\Delta$G = Gibbs energy of the reaction (positive for spontaneously unfavorable synthesis, kJ/mol);\n- $\\Delta$G$^{o'}$ = 30.5 kJ/mol standard biological Gibbs energy for ATP synthesis;\n- R = 8.314 J/mol/K (universal gas constant);\n- T=310 K (physiological temperature);\n- nH$^{+}$ = 1 (number of protons involved in the reaction);\n- [ADP], [Pi], [ATP] = molar concentrations of reactants and product\n\n\n[![](Eq/ATP.png)](Eq/jsp_ATP.html){target=\"_blank\"}\n\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Change the quantities involved in the expression and compare with previous visualizations. For example, temperature, pH, and ADP and Pi levels.\n```\n\n\n## Variation of Gibbs energy with temperature\n\n\n### Context: {.unnumbered}\n\n| The Gibbs-Helmholtz relation predicts that Gibbs energy varies nonlinearly with temperature in reactions involving a change in the heat capacity of the system ($\\Delta$Cp). This expanded form of the Gibbs equation for variable heat capacity is found in various biochemical phenomena, such as in the phase transition of biomembrane structures subjected to a compound challenge, or in the conformational change that accompanies the protein structure under heating. \\\n\n### Equation: {.unnumbered}\n\n$$\n\\Delta G(T) = \\Delta H^\\circ - T\\,\\Delta S^\\circ + \\Delta C_p \\left(T - T_0 - T \\ln\\left(\\frac{T}{T_0}\\right)\\right)\n$$\n\n*Where*,\n\n- $\\Delta$G(T) = Gibbs energy of the reaction at each temperature value, kJ/mol);\n- $\\Delta$H$^{o}$ = standard enthalpy of the reaction at T$_{0}$, normally 298 K (J/mol);\n- $\\Delta$S$^{o}$ = standard entropy of the reaction at T$_{0}$;\n- $\\Delta$Cp = variation in the heat capacity of the reaction (J/mol·K), assumed to be constant with temperature;\n- T = temperature of interest (K);\n- T$_{0}$ = reference temperature, usually 298 K.\n- R = 8.314 J/mol/K (universal gas constant);\n\n\n[![](Eq/gibbs.png)](Eq/jsp_gibbs.html){target=“_blank”}\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Try varying one or more parameters of the expression;\n2. Test the behavior of the Gibbs curve at a high reference temperature (simulation for extremophile organism);\n3. Simulate the situation where the variation in heat capacity is zero.\n```\n\n\n## Electrochemical impedance spectroscopy (EIS)\n\n### Context: {.unnumbered}\n\n| Electrochemical impedance spectroscopy (EIS) is an analytical technique that measures the response of an electrochemical system to a small amplitude sinusoidal disturbance (e.g., 5-10 mV) applied over a wide frequency range (e.g., 100 kHz-1 mHz). EIS provides information about interfacial processes, such as charge transfer, ion diffusion, and passive film formation, by analyzing the complex impedance of the system. It is a non-destructive technique widely used in areas such as corrosion, batteries, fuel cells, biosensors, and protective coatings. \n\n### Equation: {.unnumbered}\n\n\n| An electrochemical impedance (EIS) model with typical equivalent circuit components constitutes the modified Randles model: series resistor *Rs*, a resistor *Rp* in parallel with a *CPE* (Constant Phase Element), and a *Warburg* element. A common representation for EIS is the *Nyquist* plot, where the real axis represents resistance (Zre) and the imaginary axis represents negative reactance (−Zim). The formalism involved is in the equation below:\n\n\n$$\nZ_{\\text{total}}(\\omega) = R_s + \\left[ \\left( \\frac{1}{R_p} + Q (j\\omega)^n \\right)^{-1} \\right] + \\frac{\\sigma}{\\sqrt{\\omega}} (1 - j)\n$$\n\n*Where:*\n\n- Z$_{total}$ = total impedance at a given frequency;\n- $\\omega$ = angular frequency (rad/s), $\\omega$=2πf or $\\omega$=2πf;\n- R$_{p}$ = ohmic resistance (resistance of the electrolytic solution, wires, contacts, etc.);\n- R$_{p}$ = Polarization resistance (associated with charge transfer processes, such as electrochemical reactions);\n- *Q* = Constant associated with the constant phase element (CPE), replaces an ideal capacitor to represent non-ideal behaviors;\n- *n* = CPE exponent, between 0 and 1; defines the degree of ideality of the capacitive behavior (n = 1: ideal capacitor; n < 1: dispersion);\n- $\\sigma$ = Warburg coefficient, associated with ion diffusion in the electrochemical system;\n- *j* = Imaginary unit, j$^{2}$ = −1;\n\n\n| An electrochemical impedance model (EIS) with typical equivalent circuit components constitutes the modified Randles model: series resistor *Rs*, a resistor *Rp* in parallel with a *CPE* (Constant Phase Element), and a *Warburg* element. A common representation for EIS is the *Nyquist* plot, where the real axis represents resistance (Zre) and the imaginary axis represents negative reactance (−Zim).\n \n\n\n[![](Eq/EIS.png)](Eq/jsp_EIS.html){target=“_blank”}\n\n### Suggestion {.unnumbered}\n\n```{r, eval=FALSE}\n\n1. Check the effect of Rs on the graph by setting its value to zero (solution resistance);\n2. Observe the deformation of the semicircle by varying the values of the constant phase element (e.g., Q = 1e-3; n = 0.6 - dispersion of capacitive behavior);\n2. Try combining other values of the code header parameters to highlight common situations in electroanalysis: Rs, Rp, Q, n, and sigma;\n3. Reduce the Warburg model with constant phase element to a simple Randles model, consisting only of two resistors in series, the second in parallel with an ideal capacitor, and without Warburg diffusion (sigma = 0; n = 1).\n```\n\n\n## Diagrams and flowcharts\n\n### Context: {.unnumbered}\n\n\n| Due to the nature of the *Plotly.js* library, it is also possible to generate code in *JSPlotly* without involving an equation, such as for representing diagrams, flowcharts, heredograms, among others. The example below illustrates a representation of the Krebs cycle.\n\n\n[![](Eq/krebs.png)](Eq/jsp_krebs.html){target=“_blank”}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Try repositioning enzymes and metabolites by clicking and dragging the terms;\n2. Try replacing the names in the code to produce another metabolic cycle, such as the urea cycle.\n```\n\n\n### Context: Flowchart {.unnumbered}\n\n\n[![](Eq/fluxograma.png)](Eq/jsp_fluxograma.html){target=“_blank”}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Reposition terms and connectors by dragging with the mouse;\n2. For a different flowchart in the content, modify the terms in the code;\n2. For a different flowchart format, change the font and connector characteristics in the “annotations” constant.\n\n\n```\n\n\n## **Data analysis** {.unnumbered}\n\n## User data insertion\n\n| Sometimes it is interesting to work with discrete data itself, seeking a trend, mathematical or simply visual, for the relationship between variables. Here is an example of an interactive graph with user data.\n\\\n\n[![](Eq/dados.png)](Eq/jsp_dados.html){target=“_blank”}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Try changing the data entered, overlaying the graph or not;\n2. Try changing the data representation in “mode” and “type” to points, lines, points+lines, bars.\n```\n\n\\\n\n\n## Uploading files for analysis\n\n### Context - CSV file {.unnumbered}\n\n| Sometimes, it is necessary to analyze results related to a set of data in a spreadsheet. For this situation, the following example illustrates the loading of two data vectors from a *CSV* (*comma separated value*) file, a format commonly used for exporting/importing in spreadsheets, and the resulting graph. \n\n[![](Eq/csv.png)](Eq/jsp_csv.html){target=“_blank”}\n\n**Instructions:**\n\n- 1 Click on *add plot* and select a CSV file using the *browse* button at the top. Note: variable *X* in the first column of the file, and variable *Y* in the second column;\n- 2. Click on *add plot* again to view the resulting graph.\n\n```{r, eval=FALSE}\n1. Try other CSV files;\n2. Vary the aspects of the graph, such as type, color, marker size, etc.\n```\n\n\n## Linear data adjustment\n\n### Context: {.unnumbered}\n\n| In various experimental research situations, it is necessary to correlate the data of a dependent variable with a predictor variable using the following equation.\n\n\n### Equation: {.unnumbered}\n\n\n$$\ny = \\alpha x + \\beta + \\varepsilon\n$$\n*Where:*\n\n- y = dependent variable;\n- x = independent variable;\n- $\\alpha$ = slope of the adjusted line;\n- $\\beta$ = intercept of the adjusted line;\n- $\\epsilon$ = measurement error.\n\n\n| The parameters of *slope and intercept* can be obtained by several procedures, such as *least squares*, *matrix algebra*, or simple *summaries*. In the latter case, the calculation of parameters and error can be computed as follows:\n\n$$\n\\alpha = \\frac{n \\sum x_i y_i - \\sum x_i \\sum y_i}{n \\sum x_i^2 - \\left( \\sum x_i \\right)^2}\n$$\n\n$$\n\\beta = \\frac{\\sum y_i - \\alpha \\sum x_i}{n}\n$$\n\n$$\n\\hat{y}_i = \\alpha x_i + \\beta\n$$\n\n$$\n\\varepsilon_i = \\left| y_i - \\hat{y}_i \\right|\n$$\n\n\n\n| A representation for linear adjustment with arbitrary data is provided below:\n\\\n\n[![](Eq/ajLin.png)](Eq/jsp_ajLin.html){target=“_blank”}\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Show the points that overlap or do not overlap the fit line. For overlap, choose “showPoints = true” and “showLine = true”;\n2. Change the data and perform a new fit to obtain other parameters of the line.\n```\n\n\n## ANOVA and Tukey-HSD test\n\n### Context: {.unnumbered}\n\n| In research, it is common to analyze a set of data by comparing the variance between groups with that obtained within each group, or *Analysis of Variance (ANOVA)*. Once statistical information indicating that there is a difference between groups greater than the internal difference has been obtained, a *post hoc* test is performed to compare means, such as the *Tukey-HSD test* (*Honest Significant Difference*). \n\n### Equation: {.unnumbered}\n\n| The equation that characterizes a Tukey-HSD test is provided below (correction for unbalanced groups):\n\n\n$$\n\\text{HSD}_{ij} = q_{\\alpha} \\cdot \\sqrt{\\frac{\\text{MS}_{\\text{within}}}{2} \\left( \\frac{1}{n_i} + \\frac{1}{n_j} \\right)}\n$$\n\n*Where:*\n\n- HSD = minimum value of the difference between two means for it to be considered significant;\n- q$_{\\alpha}$ = critical value of the studentized distribution *q* (Tukey distribution), depending on the number of groups and the significance level $\\alpha$;\n- MS$_{within}$ = mean square within groups (error) obtained from ANOVA;\n- n: number of observations per group (*i* and *j* if there are groups of different sizes).\n\\\n\n\n[![](Eq/tukey.png)](Eq/jsp_tukey.html){target=“_blank”}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. You can click and drag the minimum difference markers (a, b, etc.) above the graph for better visual adjustment, as well as the ANOVA table and the statistical test result;\n2. Change the values of the vectors, redo the analysis and the graph simultaneously, and notice the difference in the values obtained. Note that, as stated at the bottom, you need to refresh the website page to clear previous data retained in the cache;\n3. Enter other data in the respective vectors, either your own or from another source;\n4. Enter new data vectors, or delete some, for a customized calculation and graph.\n\n```\n\n\n## Nonlinear data fit\n\n### Context: {.unnumbered}\n\n| Modeling is a common area of employment in the natural sciences, when mathematical prediction or correlation of experimental data is desired. Models can be linear or non-linear. When non-linear, they can be applied empirically to the data (e.g., quadratic, logarithmic, exponential, or power functions), or from a mathematical function that explains the model.\n \n\n| In this case, techniques for nonlinear adjustment of the data to the model are used, such as *Simplex*, *Gauss*, *Newton-Raphson*, *Levenberg-Marquardt*, or *least squares*, for example. Regardless of the method, nonlinear adjustment differs from linear adjustment in its assumptions and data treatment (see a quick explanation [here](https://bioquanti.netlify.app/pt/nivel/superior/r/enzimas#ajuste-n%C3%A3o-linear).\n \n\n| The following example illustrates the application of a nonlinear adjustment of molecular interaction data using the Langmuir model and treatment by *manual scan least squares*. In this treatment, the *sum of the least squares errors (RMSE)* is calculated for combinations of *a* and *b*, selecting the pair with the lowest calculated error. In this case, for simplicity, although *JSPlotly* works with more specific libraries, the nonlinear regression is performed by least squares, but using *grid search* rather than classic iterative methods. Thus, a set of values is tested for the pair (a, b) in a previously defined grid (combination table), allowing the identification of the parameters that best describe the experimental data according to the minimum error criterion.\n\n### Equation: {.unnumbered}\n\n| The Langmuir equation is represented below:\n\n$$\nY = \\frac{aX}{K_d + X}\n$$\n*Where:*\n\n- Y = fraction of occupied sites;\n- X = concentration of free ligand;\n- *a* = saturation value (sites of the same affinity completely occupied);\n- *Kd* = equilibrium dissociation constant of the complex.\n\n\n\n| In this case, the nonlinear least squares function is:\n\n$$\nSSR(a, K_d) = \\sum_{i=1}^n \\left( y_i - \\frac{a x_i}{K_d + x_i} \\right)^2\n$$\n\n\n*Where:*\n\n*SSR* = sum of the squares of the residuals (inversely proportional to the quality of the fit)\n\\\n\n\n[![](Eq/ajNonLin.png)](Eq/jsp_ajNonLin.html){target=“_blank”}\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. As in the previous example, alternately display the points and the adjustment curve using the “Boolean” operation (“showPoints = true/false”; “showCurve = true/false”);\n2. Change the data and perform a new fit to obtain other parameters of the equation (Kd, SSR, R², adjusted R²). Note: R² adj corresponds to the value of R² corrected for the number of parameters in the model (in this case, “2”), directly affecting the “degrees of freedom” for the fit.\n```\n","srcMarkdownNoYaml":"\n\n| To illustrate the potential use of *JSPlotly* for biochemistry and related fields, here are some examples of simulations and data analysis whose graphs are often found in textbooks and related content. To get the most out of each topic, try following the suggestions for *parametric manipulation* in each topic.\n\\\n\n## Instructions {.unnumbered}\n\n\n```{r, eval=FALSE}\n\n1. Choose a topic;\n2. Click on the corresponding graph;\n3. Click on \"Add Plot\";\n4. Use the mouse for interactivity and/or edit the code.\n\nReminder: the editor uses infinite undo/redo in the code (Ctrl+Z / Shift+Ctrl+Z)!\n```\n\n\n## Acid-base equilibrium and buffer systems\n\n#### Context: {.unnumbered}\n\n| The example illustrates the addition of a base to a system containing a weak acid and its conjugate base. The titration equation refers to a *triprotic acid*, the phosphoric acid of the buffer of the same name, but it would also work for many others, such as those present in the Krebs cycle (citrate, isocitrate). \n\n\n#### Equation: {.unnumbered}\n\n$$\nfa= \\frac{1}{1 + 10^{pKa1 - pH}} + \\frac{1}{1 + 10^{pKa2 - pH}} + \\frac{1}{1 + 10^{pKa3 - pH}}\n$$\n*Where\nfa = acid fraction (protonatable groups)\n\\\n\n[![](Eq/tit_acbase.png)](Eq/jsp_acbase.html){target=\"_blank\"}\n\\\n<!---div class=\"jsplotly_sup-fundo\"> --->\n\n### Suggestion: {.unnumbered}\n\n```{r, eval =FALSE}\n\"A. Converting the phosphate buffer (triprotic) curve to bicarbonate buffer (diprotic)\"\n\n1. Change the pKa values for the bicarbonate buffer: pKa1 = 6.1, and pKa2 = 10.3;\n2. Set a very large value for pKa3 (e.g., 1e20). \n3. Click \"add plot.\"\n\nExplanation: pKa is a term that represents the logarithm of a dissociation constant (-log[Ka]). With an extreme value, the denominator becomes equally large, canceling out the term that carries pKa3. In JavaScript and other languages, ‘e’ represents the notation for power of 10.\n\n\"B. Converting the bicarbonate buffer curve to acetate\"\n\n1. Simply repeat the above procedure with pKa1 = 4.75 and eliminate pKa2.\n\n```\n\\\n\n## Net charge network in peptides\n\n#### Context: {.unnumbered}\n\n| The code refers to the net charge network present in any sequence of amino acid residues. Here we illustrate *angiotensin II*, an important peptide for blood pressure regulation and electrolyte balance, whose converting enzyme is associated with the mechanism of cell invasibility by SARS-CoV-2.\n\n\n#### Equation: {.unnumbered}\n\n| There is no direct equation for this simulation, as the algorithm needs to decide the charge based on the basic or acidic nature of the residue at a given pH value (see the *script*). Thus:\n\n$$\nq =\n\\begin{cases}\n-\\dfrac{1}{1 + 10^{pK_a - pH}} & \\text{(acid group)} \\\\\\\\\n\\dfrac{1}{1 + 10^{pH - pK_a}} & \\text{(basic group)}\n\\end{cases}\n$$\n\\\n\n*Where\n\n- pKa = value of the antilogarithm of base 10 for the acid dissociation equilibrium constant, Ka (or log[Ka]).\n\n\n[![](Eq/cargaAA.png)](Eq/jsp_cargaAA.html){target=\"_blank\"}\n\\\n<!---div class=\"jsplotly_sup-fundo\"> --->\n\n### Suggestion: {.unnumbered}\n\n```{r, eval =FALSE}\n1. Select the peptide sequence below and observe the charge distribution:\n\n\"Ala,Lys,Arg,Leu,Phe,Glu,Cys,Asp,His\"\n\n2. Simulate the pH condition of the stomach (\"const pH = 1.5\") and check the change in charges in the peptide. \n\n3. Select a physiological peptide (e.g., oxytocin), observe its charge in blood (pH 7.5), and reflect on its potential for electrostatic interaction with cellular components.\n\n\"Cys,Tyr,Ile,Gln,Asn,Cys,Pro,Leu,Gly\" - oxytocin\n```\n\\\n\n\n## Interaction of oxygen with myoglobin and hemoglobin\n\n#### Context: {.unnumbered}\n\n| The oxygen molecule can combine with the *heme* group of myoglobin and hemoglobin in different ways, depending on the cooperativity exhibited in the latter due to its quaternary structure. The following model illustrates this interaction using the *Hill equation*. \n\n\n#### Equation: {.unnumbered}\n\n\n$$\nY= \\frac{pO_2^{nH}}{p_{50}^{nH} + pO_2^{nH}}\n$$\n\\\n\n*Where*\n\nY = degree of oxygen saturation in the protein;\n\n\n- pO$_{2}$ = oxygen pressure;\n- p$_{50}$ = oxygen pressure at 50% saturation;\n- nH = Hill coefficient for the interaction;\n\\\n\n\n[![](Eq/O2.png)](Eq/jsp_O2.html){target=\"_blank\"}\n\\\n<!---div class=\"jsplotly_sup-fundo\"> --->\n\n### Suggestion: {.unnumbered}\n\n```{r, eval =FALSE}\n1. Run the application (\"add plot\"). Note that the value of \"nH\" for the Hill constant is \"1,\" meaning there is no cooperativity effect.\n\n2. Now replace the value of \"nH\" with the Hill coefficient for hemoglobin, 2.8, and run again!\n```\n\\\n\n\n## Bohr effect on hemoglobin (pH)\n\n\n#### Context: {.unnumbered}\n\n| Some physiological or pathological conditions can alter the binding affinity of oxygen to hemoglobin, such as temperature, certain metabolites (2,3-BPG), and the hydrogen ion content of the solution.\n\n#### Equation: {.unnumbered}\n\n$$\nY(pO_2) = \\frac{{pO_2^n}}{{P_{50}^n + pO_2^n}}, \\quad \\text{with } P_{50} = P_{50,\\text{ref}} + \\alpha (pH_{\\text{ref}} - pH)\n$$\n\\\n*Where*,\n\n- Y = hemoglobin saturation,\n- pO$_{2}$ = partial pressure of oxygen (in mmHg),\n- P$_{50}$ = pressure of O$_{2}$ at which hemoglobin is 50% saturated,\n- P$_{50,ref}$ = 26 mmHg (standard value),\n- $\\alpha$ = 50 (Bohr effect intensity),\n- pH$_{ref}$ = 7.4,\n- n = 2.8 = Hill coefficient for hemoglobin.\n\n\n\n[![](Eq/jspl_bohr.png)](Eq/jspl_bohr.html)\n\n\n\n## Isoelectric Point in Proteins\n\n\n#### Context: {.unnumbered}\n\n| The *script* for this simulation is based on the distribution of the charge network for a polyelectrolyte, and the identification of the pH value at which this network is zero, i.e., the *isoelectric point (or isoionic point), pI*. The example uses the primary sequence of lysozyme, a hydrolase that acts to break down the microbial wall.\n\n#### Equation: {.unnumbered}\n\n\n$$\nq_{\\text{net}}(pH) = \\sum_{i=1}^{N} \\left[ n_i \\cdot q_{B_i} + \\frac{n_i}{1 + 10^{pH - pK_{a_i}}} \\right]\n$$\n\\\n*Where*,\n\n- qnet = total net charge;\n- qB$_{i} = charge of the basic form for residue i (e.g., +1 for Lys, 0 for Asp);\n- n$_{i}$ = number of groups of residue *i*.\n\n[![](Eq/pI.png)](Eq/jsp_pI.html)\n\n\n#### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n\"Finding the pI for other proteins\"\n\n1. You can check the titration of any other protein or peptide sequence by simply replacing the primary sequence contained in the code. An assertive way to perform this replacement involves:\na. Search for the \"FASTA\" sequence of the protein in NCBI (\"https://www.ncbi.nlm.nih.gov/protein/\") - e.g., \"papain\";\nb. Click on \"FASTA\" and copy the sequence 1a. obtained;\nc. Paste the sequence into a website for residue quantification (e.g., \"https://www.protpi.ch/Calculator/ProteinTool\");\n4. Replace the sequence in the code. \n```\n\\\n\n\n## Catalysis and enzyme inhibition\n\n### Context: {.unnumbered}\n\n| The simulation aims to provide a general equation for enzyme inhibition studies, covering *competitive, non-competitive, and competitive (pure or mixed) models*, also allowing the study of enzyme catalysis in the absence of an inhibitor.\n#### Equation: {.unnumbered}\n\n\n$$\nv=\\frac{Vm*S}{Km(1+\\frac{I}{Kic})+S(1+\\frac{I}{Kiu})}\n$$\n\\\n*Where*\n\n- S = substrate content for reaction;\n- Vm = reaction limit speed (in books, maximum speed);\n- Km = Michaelis-Mentem constant;\n- Kic = inhibitor dissociation equilibrium constant for competitive model;\n- Kiu = inhibitor dissociation equilibrium constant for non-competitive model\n\\\n\n\n[![](Eq/kin_inib.png)](Eq/jsp_kin_inib.html){target=\"_blank\"}\n\\\n<!---div class=\"jsplotly_sup-fundo\"> --->\n\n### Suggestion: {.unnumbered}\n\n```{r, eval =FALSE}\n\"A. Enzymatic catalysis in the absence of inhibitor.\"\n1. Just run the application with the general equation. Note that the values for Kic and Kiu are high (1e20). Thus, with high \"dissociation constants,\" the interaction of the inhibitor with the enzyme is irrelevant, returning the model to the classic Michaelis-Mentem equation.\n2. Try changing the values of Vm and Km, comparing graphs.\n3. Use the geographic coordinates feature on the icon bar (\"Toggle Spike Lines\") to consolidate the mathematical meaning of Km, as well as to observe the effect of different values on the graph.\n\n\"B. Competitive inhibition model.\"\n1. To observe or compare the Michaelis model with the competitive inhibition model, simply replace the value of Kic with a consistent number (e.g., Kic= 3).\n\n\"C. Incompetitive inhibition model.\"\n1. The same suggestion above applies to the incompetitive model, this time replacing the value for Kiu.\n\n\"D. Pure non-competitive inhibition model.\"\n1. In this model, the simulation is performed using equal values for Kic and Kiu.\n\n\"E. Mixed non-competitive inhibition model.\"\n1. For this model, simply assign different values to Kic and Kiu.\n```\n\\\n\n## Thermodynamic stability of nucleic acids\n\n### Context: {.unnumbered}\n\n| Several factors contribute to the thermodynamic stability of biopolymers, either stabilizing or destabilizing them. This simulation deals with a thermal denaturation curve for DNA in the presence or absence of some of these compounds: trehalose (stabilizing osmolyte) and guanidine chloride (destabilizing).\n\n\n### Equation: {.unnumbered}\n\n$$\ny(T) = \\frac{1}{1 + e^{-\\frac{T - T_m}{\\beta}}}\n$$\n\n\n*Where*,\n\n- y(T): fraction of denatured DNA at a given temperature T;\n- Tm: transition temperature (*melting*, temperature at which 50% of molecules are double-stranded and 50% are single-stranded);\n- $\\beta$: parameter that adjusts the slope of the curve (affected by trehalose and guanidine).\n\n\n*Note:*\n\n1. Trehalose as a stabilizer (reduces $\\beta$);\n2. Guanidine as a denaturant (increases $\\beta$);\n\n\n[![](Eq/denat_DNA.png)](Eq/jsp_denat_DNA_no_osmol.html){target=\"_blank\"}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Try testing various conditions involved in the simulation, such as:\na) variation of Tm;\nb) variation of the $\\beta$ parameter;\nc) variation of trehalose content;\nd) variation of guanidine chloride content.\n```\n\n\n## Van der Waals equation for ideal gases\n\n\n### Context: {.unnumbered}\n\n| An adaptation that relates the thermodynamic quantities of pressure, volume, and temperature for ideal gases is the *van der Waals equation*. In this equation, coefficients are calculated that estimate the existence of a volume and interparticle interactions. Thus, the van der Waals equation corrects the ideal gas equation by considering a term to compensate for intermolecular forces (a/V$^{2}$) and the available volume, which discounts the volume occupied by the gas molecules themselves.\n\n\n| The simulation offers additional interactivity through the presence of sliders for temperature and for the finite volume coefficient (*b*) and particle interaction coefficient (*a*).\n\n### Equation: {.unnumbered}\n\n\n$$\nP = \\frac{RT}{V - b} - \\frac{a}{V^2}\n$$\n\n- P = gas pressure (atm);\n- V = molar volume (L);\n- T = temperature (K);\n- R = 0.0821 = ideal gas constant (L·atm/mol·K);\n- a = intermolecular attraction constant (L$^{2}$·atm/mol$^{2})\n- b = excluded volume constant (L/mol)\n\n\n\n[![](Eq/vanderWaals.png)](Eq/jsp_vanderWaals.html){target=\"_blank\"}\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n\n1. Try varying the parameters of the equation using the slider for temperature, as well as for coefficients \"a and b.\"\n2. Discuss which of the coefficients has the greatest effect on the curve profile and the reason for this.\n\n```\n\\\n\n## Equilibrium of ATP production from reactants, temperature, and pH\n\n### Context: {.unnumbered}\n\n| Intracellular ATP production involves the classic chemical equilibrium relationship between reactants and products as a function of reaction temperature, adjusted to a specific pH value. By varying one or both reactant concentrations or physical-chemical parameters, it is possible to quantify the product using the following thermodynamic reaction:\n\n\n### Equation: {.unnumbered}\n\n$$\n\\Delta G = \\Delta G^{\\circ'} + RT \\ln\\left(\\frac{[\\text{ADP}] \\cdot [\\text{P}_i]}{[\\text{ATP}]}\\right) + 2{,}303 \\cdot RT \\cdot n_H \\cdot \\text{pH}\n$$\n\n*Where*,\n\n- $\\Delta$G = Gibbs energy of the reaction (positive for spontaneously unfavorable synthesis, kJ/mol);\n- $\\Delta$G$^{o'}$ = 30.5 kJ/mol standard biological Gibbs energy for ATP synthesis;\n- R = 8.314 J/mol/K (universal gas constant);\n- T=310 K (physiological temperature);\n- nH$^{+}$ = 1 (number of protons involved in the reaction);\n- [ADP], [Pi], [ATP] = molar concentrations of reactants and product\n\n\n[![](Eq/ATP.png)](Eq/jsp_ATP.html){target=\"_blank\"}\n\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Change the quantities involved in the expression and compare with previous visualizations. For example, temperature, pH, and ADP and Pi levels.\n```\n\n\n## Variation of Gibbs energy with temperature\n\n\n### Context: {.unnumbered}\n\n| The Gibbs-Helmholtz relation predicts that Gibbs energy varies nonlinearly with temperature in reactions involving a change in the heat capacity of the system ($\\Delta$Cp). This expanded form of the Gibbs equation for variable heat capacity is found in various biochemical phenomena, such as in the phase transition of biomembrane structures subjected to a compound challenge, or in the conformational change that accompanies the protein structure under heating. \\\n\n### Equation: {.unnumbered}\n\n$$\n\\Delta G(T) = \\Delta H^\\circ - T\\,\\Delta S^\\circ + \\Delta C_p \\left(T - T_0 - T \\ln\\left(\\frac{T}{T_0}\\right)\\right)\n$$\n\n*Where*,\n\n- $\\Delta$G(T) = Gibbs energy of the reaction at each temperature value, kJ/mol);\n- $\\Delta$H$^{o}$ = standard enthalpy of the reaction at T$_{0}$, normally 298 K (J/mol);\n- $\\Delta$S$^{o}$ = standard entropy of the reaction at T$_{0}$;\n- $\\Delta$Cp = variation in the heat capacity of the reaction (J/mol·K), assumed to be constant with temperature;\n- T = temperature of interest (K);\n- T$_{0}$ = reference temperature, usually 298 K.\n- R = 8.314 J/mol/K (universal gas constant);\n\n\n[![](Eq/gibbs.png)](Eq/jsp_gibbs.html){target=“_blank”}\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Try varying one or more parameters of the expression;\n2. Test the behavior of the Gibbs curve at a high reference temperature (simulation for extremophile organism);\n3. Simulate the situation where the variation in heat capacity is zero.\n```\n\n\n## Electrochemical impedance spectroscopy (EIS)\n\n### Context: {.unnumbered}\n\n| Electrochemical impedance spectroscopy (EIS) is an analytical technique that measures the response of an electrochemical system to a small amplitude sinusoidal disturbance (e.g., 5-10 mV) applied over a wide frequency range (e.g., 100 kHz-1 mHz). EIS provides information about interfacial processes, such as charge transfer, ion diffusion, and passive film formation, by analyzing the complex impedance of the system. It is a non-destructive technique widely used in areas such as corrosion, batteries, fuel cells, biosensors, and protective coatings. \n\n### Equation: {.unnumbered}\n\n\n| An electrochemical impedance (EIS) model with typical equivalent circuit components constitutes the modified Randles model: series resistor *Rs*, a resistor *Rp* in parallel with a *CPE* (Constant Phase Element), and a *Warburg* element. A common representation for EIS is the *Nyquist* plot, where the real axis represents resistance (Zre) and the imaginary axis represents negative reactance (−Zim). The formalism involved is in the equation below:\n\n\n$$\nZ_{\\text{total}}(\\omega) = R_s + \\left[ \\left( \\frac{1}{R_p} + Q (j\\omega)^n \\right)^{-1} \\right] + \\frac{\\sigma}{\\sqrt{\\omega}} (1 - j)\n$$\n\n*Where:*\n\n- Z$_{total}$ = total impedance at a given frequency;\n- $\\omega$ = angular frequency (rad/s), $\\omega$=2πf or $\\omega$=2πf;\n- R$_{p}$ = ohmic resistance (resistance of the electrolytic solution, wires, contacts, etc.);\n- R$_{p}$ = Polarization resistance (associated with charge transfer processes, such as electrochemical reactions);\n- *Q* = Constant associated with the constant phase element (CPE), replaces an ideal capacitor to represent non-ideal behaviors;\n- *n* = CPE exponent, between 0 and 1; defines the degree of ideality of the capacitive behavior (n = 1: ideal capacitor; n < 1: dispersion);\n- $\\sigma$ = Warburg coefficient, associated with ion diffusion in the electrochemical system;\n- *j* = Imaginary unit, j$^{2}$ = −1;\n\n\n| An electrochemical impedance model (EIS) with typical equivalent circuit components constitutes the modified Randles model: series resistor *Rs*, a resistor *Rp* in parallel with a *CPE* (Constant Phase Element), and a *Warburg* element. A common representation for EIS is the *Nyquist* plot, where the real axis represents resistance (Zre) and the imaginary axis represents negative reactance (−Zim).\n \n\n\n[![](Eq/EIS.png)](Eq/jsp_EIS.html){target=“_blank”}\n\n### Suggestion {.unnumbered}\n\n```{r, eval=FALSE}\n\n1. Check the effect of Rs on the graph by setting its value to zero (solution resistance);\n2. Observe the deformation of the semicircle by varying the values of the constant phase element (e.g., Q = 1e-3; n = 0.6 - dispersion of capacitive behavior);\n2. Try combining other values of the code header parameters to highlight common situations in electroanalysis: Rs, Rp, Q, n, and sigma;\n3. Reduce the Warburg model with constant phase element to a simple Randles model, consisting only of two resistors in series, the second in parallel with an ideal capacitor, and without Warburg diffusion (sigma = 0; n = 1).\n```\n\n\n## Diagrams and flowcharts\n\n### Context: {.unnumbered}\n\n\n| Due to the nature of the *Plotly.js* library, it is also possible to generate code in *JSPlotly* without involving an equation, such as for representing diagrams, flowcharts, heredograms, among others. The example below illustrates a representation of the Krebs cycle.\n\n\n[![](Eq/krebs.png)](Eq/jsp_krebs.html){target=“_blank”}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Try repositioning enzymes and metabolites by clicking and dragging the terms;\n2. Try replacing the names in the code to produce another metabolic cycle, such as the urea cycle.\n```\n\n\n### Context: Flowchart {.unnumbered}\n\n\n[![](Eq/fluxograma.png)](Eq/jsp_fluxograma.html){target=“_blank”}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Reposition terms and connectors by dragging with the mouse;\n2. For a different flowchart in the content, modify the terms in the code;\n2. For a different flowchart format, change the font and connector characteristics in the “annotations” constant.\n\n\n```\n\n\n## **Data analysis** {.unnumbered}\n\n## User data insertion\n\n| Sometimes it is interesting to work with discrete data itself, seeking a trend, mathematical or simply visual, for the relationship between variables. Here is an example of an interactive graph with user data.\n\\\n\n[![](Eq/dados.png)](Eq/jsp_dados.html){target=“_blank”}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Try changing the data entered, overlaying the graph or not;\n2. Try changing the data representation in “mode” and “type” to points, lines, points+lines, bars.\n```\n\n\\\n\n\n## Uploading files for analysis\n\n### Context - CSV file {.unnumbered}\n\n| Sometimes, it is necessary to analyze results related to a set of data in a spreadsheet. For this situation, the following example illustrates the loading of two data vectors from a *CSV* (*comma separated value*) file, a format commonly used for exporting/importing in spreadsheets, and the resulting graph. \n\n[![](Eq/csv.png)](Eq/jsp_csv.html){target=“_blank”}\n\n**Instructions:**\n\n- 1 Click on *add plot* and select a CSV file using the *browse* button at the top. Note: variable *X* in the first column of the file, and variable *Y* in the second column;\n- 2. Click on *add plot* again to view the resulting graph.\n\n```{r, eval=FALSE}\n1. Try other CSV files;\n2. Vary the aspects of the graph, such as type, color, marker size, etc.\n```\n\n\n## Linear data adjustment\n\n### Context: {.unnumbered}\n\n| In various experimental research situations, it is necessary to correlate the data of a dependent variable with a predictor variable using the following equation.\n\n\n### Equation: {.unnumbered}\n\n\n$$\ny = \\alpha x + \\beta + \\varepsilon\n$$\n*Where:*\n\n- y = dependent variable;\n- x = independent variable;\n- $\\alpha$ = slope of the adjusted line;\n- $\\beta$ = intercept of the adjusted line;\n- $\\epsilon$ = measurement error.\n\n\n| The parameters of *slope and intercept* can be obtained by several procedures, such as *least squares*, *matrix algebra*, or simple *summaries*. In the latter case, the calculation of parameters and error can be computed as follows:\n\n$$\n\\alpha = \\frac{n \\sum x_i y_i - \\sum x_i \\sum y_i}{n \\sum x_i^2 - \\left( \\sum x_i \\right)^2}\n$$\n\n$$\n\\beta = \\frac{\\sum y_i - \\alpha \\sum x_i}{n}\n$$\n\n$$\n\\hat{y}_i = \\alpha x_i + \\beta\n$$\n\n$$\n\\varepsilon_i = \\left| y_i - \\hat{y}_i \\right|\n$$\n\n\n\n| A representation for linear adjustment with arbitrary data is provided below:\n\\\n\n[![](Eq/ajLin.png)](Eq/jsp_ajLin.html){target=“_blank”}\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. Show the points that overlap or do not overlap the fit line. For overlap, choose “showPoints = true” and “showLine = true”;\n2. Change the data and perform a new fit to obtain other parameters of the line.\n```\n\n\n## ANOVA and Tukey-HSD test\n\n### Context: {.unnumbered}\n\n| In research, it is common to analyze a set of data by comparing the variance between groups with that obtained within each group, or *Analysis of Variance (ANOVA)*. Once statistical information indicating that there is a difference between groups greater than the internal difference has been obtained, a *post hoc* test is performed to compare means, such as the *Tukey-HSD test* (*Honest Significant Difference*). \n\n### Equation: {.unnumbered}\n\n| The equation that characterizes a Tukey-HSD test is provided below (correction for unbalanced groups):\n\n\n$$\n\\text{HSD}_{ij} = q_{\\alpha} \\cdot \\sqrt{\\frac{\\text{MS}_{\\text{within}}}{2} \\left( \\frac{1}{n_i} + \\frac{1}{n_j} \\right)}\n$$\n\n*Where:*\n\n- HSD = minimum value of the difference between two means for it to be considered significant;\n- q$_{\\alpha}$ = critical value of the studentized distribution *q* (Tukey distribution), depending on the number of groups and the significance level $\\alpha$;\n- MS$_{within}$ = mean square within groups (error) obtained from ANOVA;\n- n: number of observations per group (*i* and *j* if there are groups of different sizes).\n\\\n\n\n[![](Eq/tukey.png)](Eq/jsp_tukey.html){target=“_blank”}\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. You can click and drag the minimum difference markers (a, b, etc.) above the graph for better visual adjustment, as well as the ANOVA table and the statistical test result;\n2. Change the values of the vectors, redo the analysis and the graph simultaneously, and notice the difference in the values obtained. Note that, as stated at the bottom, you need to refresh the website page to clear previous data retained in the cache;\n3. Enter other data in the respective vectors, either your own or from another source;\n4. Enter new data vectors, or delete some, for a customized calculation and graph.\n\n```\n\n\n## Nonlinear data fit\n\n### Context: {.unnumbered}\n\n| Modeling is a common area of employment in the natural sciences, when mathematical prediction or correlation of experimental data is desired. Models can be linear or non-linear. When non-linear, they can be applied empirically to the data (e.g., quadratic, logarithmic, exponential, or power functions), or from a mathematical function that explains the model.\n \n\n| In this case, techniques for nonlinear adjustment of the data to the model are used, such as *Simplex*, *Gauss*, *Newton-Raphson*, *Levenberg-Marquardt*, or *least squares*, for example. Regardless of the method, nonlinear adjustment differs from linear adjustment in its assumptions and data treatment (see a quick explanation [here](https://bioquanti.netlify.app/pt/nivel/superior/r/enzimas#ajuste-n%C3%A3o-linear).\n \n\n| The following example illustrates the application of a nonlinear adjustment of molecular interaction data using the Langmuir model and treatment by *manual scan least squares*. In this treatment, the *sum of the least squares errors (RMSE)* is calculated for combinations of *a* and *b*, selecting the pair with the lowest calculated error. In this case, for simplicity, although *JSPlotly* works with more specific libraries, the nonlinear regression is performed by least squares, but using *grid search* rather than classic iterative methods. Thus, a set of values is tested for the pair (a, b) in a previously defined grid (combination table), allowing the identification of the parameters that best describe the experimental data according to the minimum error criterion.\n\n### Equation: {.unnumbered}\n\n| The Langmuir equation is represented below:\n\n$$\nY = \\frac{aX}{K_d + X}\n$$\n*Where:*\n\n- Y = fraction of occupied sites;\n- X = concentration of free ligand;\n- *a* = saturation value (sites of the same affinity completely occupied);\n- *Kd* = equilibrium dissociation constant of the complex.\n\n\n\n| In this case, the nonlinear least squares function is:\n\n$$\nSSR(a, K_d) = \\sum_{i=1}^n \\left( y_i - \\frac{a x_i}{K_d + x_i} \\right)^2\n$$\n\n\n*Where:*\n\n*SSR* = sum of the squares of the residuals (inversely proportional to the quality of the fit)\n\\\n\n\n[![](Eq/ajNonLin.png)](Eq/jsp_ajNonLin.html){target=“_blank”}\n\n\n### Suggestion: {.unnumbered}\n\n```{r, eval=FALSE}\n1. As in the previous example, alternately display the points and the adjustment curve using the “Boolean” operation (“showPoints = true/false”; “showCurve = true/false”);\n2. Change the data and perform a new fit to obtain other parameters of the equation (Kd, SSR, R², adjusted R²). Note: R² adj corresponds to the value of R² corrected for the number of parameters in the model (in this case, “2”), directly affecting the “degrees of freedom” for the fit.\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../../styles.css"],"toc":true,"toc-depth":2,"number-sections":true,"output-file":"jsptl_bioq_en.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.22","theme":{"light":"flatly"},"title":"Interactive Simulations for Biophysical Chemistry with JSPlotly & GSPlotly"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}